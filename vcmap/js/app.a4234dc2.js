(()=>{"use strict";var e={8600:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(124),o=n(8534),i=n(3087),s=n(2833),r=(n(2479),n(4944),n(3792),n(9554),n(1539),n(4747),n(7658),n(2222),n(1249),n(3843),n(3710),n(6647),n(9714),n(1532),n(8783),n(3948),n(5556)),l=n(8583),c=n(7577);function u(e,t){var n=null;if(e.orthologs){var a=Object.values(e.orthologs);n=a.flat()}return new l.Z({mapKey:e.mapKey,speciesName:t,symbol:e.geneSymbol,name:e.geneName,rgdId:e.geneRgdId,chromosome:e.chr,start:e.startPos,stop:e.stopPos,backboneStart:e.startPos,backboneStop:e.stopPos,orthologs:n||[]})}function d(e){var t={},n=function(n){var a;null===(a=e.orthologs[n])||void 0===a||a.forEach((function(e){n in t?t[n].push(u(e)):t[n]=[u(e)]}))};for(var a in e)n(a);return t}var p=function(){function e(){(0,i.Z)(this,e)}return(0,s.Z)(e,null,[{key:"getGenesBySymbol",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,o){var i,s;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.Z.get("/vcmap/genes/".concat(t,"?symbolPrefix=").concat(o));case 2:return i=e.sent,s=i.data.map((function(e){return u(e,n)})),e.abrupt("return",s);case 5:case"end":return e.stop()}}),e)})));function t(t,n,a){return e.apply(this,arguments)}return t}()},{key:"getGenesByRegion",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,o,i,s,l){var d,p,v,h,g;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return d=Math.round(n),p=Math.round(o),v=Date.now(),e.next=5,c.Z.get("/vcmap/genes/".concat(i,"/").concat(t,"/").concat(d,"/").concat(p,"?orthologMapKeys=").concat(l.toString()));case 5:return h=e.sent,g=h.data.map((function(e){return u(e,s)})),r.Z.debug("Genes By Region API: ".concat(Date.now()-v," ms"),{chromosome:t,start:n,stop:o,mapKey:i,speciesName:s,comparativeSpeciesIds:l}),e.abrupt("return",g);case 9:case"end":return e.stop()}}),e)})));function t(t,n,a,o,i,s){return e.apply(this,arguments)}return t}()},{key:"getGeneOrthologs",value:function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,o,i,s){var r,l,u,p,v;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r="",l=0;l<s.length;l++)u=s[l],l==s.length-1?r+=u:r+=u+",";return e.next=4,c.Z.get("/vcmap/genes/orthologs/".concat(t,"/").concat(n,"/").concat(o,"/").concat(i,"}?mapKeys=").concat(r.toString()));case 4:return p=e.sent,v=new Map,p.data.forEach((function(e){var t=d(e);v.set(e.gene.geneSymbol,t)})),e.abrupt("return",v);case 8:case"end":return e.stop()}}),e)})));function t(t,n,a,o,i){return e.apply(this,arguments)}return t}()}]),e}()},7577:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(594);const o={API_BASE_URL:"https://rest.rgd.mcw.edu/rgdws/"};var i=n(5556);o.API_BASE_URL||i.Z.warn("API_BASE_URL is not defined in your app configuration");var s=a.Z.create({baseURL:o.API_BASE_URL});const r=s},5556:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(1947),o="warn",i=(0,a.hu)({enabled:!0,level:o});i.time=function(e){"debug"===o&&console.time("[TIME] ".concat(e))},i.timeEnd=function(e){"debug"===o&&console.timeEnd("[TIME] ".concat(e))};const s=i},6453:(e,t,n)=>{n(6992),n(8674),n(9601),n(7727);var a=n(9963),o=n(6252);function i(e,t){var n=(0,o.up)("router-view");return(0,o.wg)(),(0,o.j4)(n)}var s=n(3744);const r={},l=(0,s.Z)(r,[["render",i]]),c=l;n(1539),n(8783),n(3948);var u=n(2201),d=n(9584),p=n(6347),v=n(124),h=n(8534),g=(n(1532),n(2222),n(7327),n(7658),n(9600),n(1249),n(1703),n(6647),n(5212),n(2564),n(8309),n(9554),n(4747),n(4553),n(7922),n(2262)),b=n(2482),f=(n(561),n(9826),n(3843),n(3710),n(6977),n(8862),n(4678),n(5147),n(3577)),m=n(1369),k=n(2525),S=n(3907),y=(n(6699),n(2023),n(8561)),w=n(7627),P=n(8114),Z=["x","y"];const B=(0,o.aZ)({__name:"ChromosomeLabelSVG",props:{syntenySection:null},setup:function(e){return function(t,n){return e.syntenySection.height>15?((0,o.wg)(),(0,o.iD)("text",{key:0,class:"chromosome-label",x:e.syntenySection.posX1+e.syntenySection.width/2,y:e.syntenySection.posY1+e.syntenySection.height/2,"dominant-baseline":"middle","text-anchor":"middle"},(0,f.zw)(e.syntenySection.chromosome),9,Z)):(0,o.kq)("",!0)}}}),D=(0,s.Z)(B,[["__scopeId","data-v-34a4f939"]]),L=D;var x=n(2095),U=["x1","x2","y1","y2"],C=["x1","x2","y1","y2"];const G=(0,o.aZ)({__name:"SyntenyLinesSVG",props:{syntenySection:null},setup:function(e){return function(t,n){return(0,o.wg)(),(0,o.iD)(o.HY,null,[e.syntenySection.isHovered?((0,o.wg)(),(0,o.iD)("line",{key:0,class:"synteny-line",x1:e.syntenySection.posX1+e.syntenySection.width,x2:(0,g.SU)(x.ZP).backboneXPosition,y1:e.syntenySection.posY1,y2:e.syntenySection.isInverted?e.syntenySection.posY2:e.syntenySection.posY1},null,8,U)):(0,o.kq)("",!0),e.syntenySection.isHovered?((0,o.wg)(),(0,o.iD)("line",{key:1,class:"synteny-line",x1:e.syntenySection.posX1+e.syntenySection.width,x2:(0,g.SU)(x.ZP).backboneXPosition,y1:e.syntenySection.posY2,y2:e.syntenySection.isInverted?e.syntenySection.posY1:e.syntenySection.posY2},null,8,C)):(0,o.kq)("",!0)],64)}}}),_=(0,s.Z)(G,[["__scopeId","data-v-0c3a28ac"]]),M=_;var Y=["x1","x2","y1","y2"];const I=(0,o.aZ)({__name:"GapSVG",props:{gapSection:null},setup:function(e){return function(t,n){return(0,o.wg)(),(0,o.iD)("line",{class:"synteny-gap",x1:e.gapSection.posX1,x2:e.gapSection.posX2,y1:e.gapSection.posY1,y2:e.gapSection.posY2},null,8,Y)}}}),H=(0,s.Z)(I,[["__scopeId","data-v-374645f1"]]),T=H;var X=["x1","y1","x2","y2","stroke"],R=["x1","y1","x2","y2","stroke"],q=["x","y"],E=["x","y"];const O=(0,o.aZ)({__name:"OverviewSyntenyLabelsSVG",props:{gaplessBlock:null},setup:function(e){var t=e,n=45;return function(e,a){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("line",{x1:t.gaplessBlock.startLabel.posX,y1:t.gaplessBlock.startLabel.posY+1,x2:t.gaplessBlock.startLabel.posX+n,y2:t.gaplessBlock.startLabel.posY+1,stroke:t.gaplessBlock.elementColor},null,8,X),(0,o._)("line",{x1:t.gaplessBlock.stopLabel.posX,y1:t.gaplessBlock.stopLabel.posY-1,x2:t.gaplessBlock.stopLabel.posX+n,y2:t.gaplessBlock.stopLabel.posY-1,stroke:t.gaplessBlock.elementColor},null,8,R),(0,o._)("text",{class:"label small","dominant-baseline":"hanging",x:t.gaplessBlock.startLabel.posX+2,y:t.gaplessBlock.startLabel.posY+1.5},(0,f.zw)(t.gaplessBlock.startLabel.text),9,q),(0,o._)("text",{class:"label small","dominant-baseline":"auto",x:t.gaplessBlock.stopLabel.posX+2,y:t.gaplessBlock.stopLabel.posY-1.5},(0,f.zw)(t.gaplessBlock.stopLabel.text),9,E)],64)}}}),V=O,z=V;function N(e,t){var n;if(null==e)return{y:0,x:0};var a=e.createSVGPoint();a.x=t.clientX,a.y=t.clientY;var o=null===(n=e.getScreenCTM())||void 0===n?void 0:n.inverse();return a=a.matrixTransform(o),a}function W(){var e,t=(0,g.iH)();(0,o.bv)((function(){e=document.querySelector("svg")}));var n=function(e,n,a,o,i){return t.value=e,o+(i-o)/(a-n)*(e-n)},a=function(n,a,o,i,s){var r=N(e,n);return t.value=r.y,i+(r.y-a)*((s-i)/(o-a))};return{getBasePairPositionFromSVG:n,getBasePairPositionFromMouseEvent:a,mouseYPos:t}}var A=n(5996),K=n(8806);function F(e){var t=function(t,n){if(t.length>0){var a=t[0],o=[a].concat((0,d.Z)(a.chainedOrthologLines)).some((function(t){return e.state.selectedGeneIds.includes(t.startGene.rgdId)||e.state.selectedGeneIds.includes(t.endGene.rgdId)})),i=n&&!o;[a].concat((0,d.Z)(a.chainedOrthologLines)).forEach((function(e){e.isHovered=i,e.startGeneDatatrack&&(e.startGeneDatatrack.isHovered=i),e.endGeneDatatrack&&(e.endGeneDatatrack.isHovered=i)}))}},n=function(n,a,o){var i,s;if(null!==(i=a.gene)&&void 0!==i&&i.rgdId&&"variant"!==a.type&&"qtl"!==a.type){if(a.isHovered=!1,e.state.selectedGeneIds.includes((null===(s=a.gene)||void 0===s?void 0:s.rgdId)||-1))return e.dispatch("setSelectedGeneIds",[]),void e.dispatch("setSelectedData",null);var r=n.shiftKey?(0,d.Z)(e.state.selectedGeneIds):[],l=[];if(a.gene){a.lines.length>0&&t(a.lines,!1);var c=a.label?a.label:void 0,u=c?c.mainGene:a.gene,p=c?c.genes.filter((function(e){return e.rgdId!==c.mainGene.rgdId})):[];(0,K.xl)(p),[u].concat((0,d.Z)(p)).forEach((function(e){var t;l.push(new y.Z(e.clone(),"Gene")),r.push(e.rgdId);var n=o.get(e.rgdId);if(null!==n&&void 0!==n&&n.orthologs&&(null===(t=n.orthologs)||void 0===t?void 0:t.length)>0){var i=n.orthologs;r.push.apply(r,(0,d.Z)(i));var s=i.map((function(e){return o.get(e)}));s.forEach((function(e){null!=e&&l.push(new y.Z(e.clone(),"Gene"))}))}if(a.lines.length>0){var c=(0,A.XK)(a.lines[0]),u=c.selectedData;u.forEach((function(e){var t=e.genomicSection;r.includes(t.rgdId)||(r.push(t.rgdId),l.push(e))}))}}))}if(e.dispatch("setSelectedGeneIds",r||[]),n.shiftKey){var v=[].concat((0,d.Z)(e.state.selectedData||[]),l);e.dispatch("setSelectedData",v)}else e.dispatch("setSelectedData",l)}},a=function(t,n,a,o){e.state.selectedGeneIds.includes(n.mainGene.rgdId)&&(e.dispatch("setSelectedGeneIds",[]),e.dispatch("setSelectedData",null));var i=t.shiftKey?(0,d.Z)(e.state.selectedGeneIds):[],s=n.mainGene,r=n.genes.filter((function(e){return e.rgdId!==n.mainGene.rgdId})),l=[];if((0,K.xl)(r),[s].concat((0,d.Z)(r)).forEach((function(e){l.push(new y.Z(e.clone(),"Gene")),i.push(e.rgdId);var t=a.get(e.rgdId);if(null!=t){if(t.orthologs&&t.orthologs.length>0){var n=t.orthologs;i.push.apply(i,(0,d.Z)(n));var s=n.map((function(e){return a.get(e)}));s.forEach((function(e){null!=e&&l.push(new y.Z(e.clone(),"Gene"))}))}var r=o.filter((function(e){return e.startGene.rgdId===t.rgdId||e.endGene.rgdId===t.rgdId}));if(null!=r&&r.length>0){var c=(0,A.XK)(r[0]),u=c.selectedData;u.forEach((function(e){var t=e.genomicSection;i.includes(t.rgdId)||(i.push(t.rgdId),l.push(e))}))}}})),e.dispatch("setSelectedGeneIds",i||[]),t.shiftKey){var c=[].concat((0,d.Z)(e.state.selectedData||[]),l);e.dispatch("setSelectedData",c)}else e.dispatch("setSelectedData",l)};return{setHoverOnGeneLinesAndDatatrackSections:t,onDatatrackSectionClick:n,onGeneLabelClick:a}}var j=["onMouseenter","onMouseleave","onMousemove","onClick","y","x","width","height","fill"],J=["onMouseenter","onMouseleave","onMousemove","y","x","width","height","fill"],Q=["x","y"],$=["x","y"],ee=["x","y"],te=["x","y"],ne=["x","y"],ae=["x1","x2","y1","y2"],oe=["onMouseenter","onMouseleave","onClick","y","x","width","height","fill","fill-opacity","stroke"];const ie=(0,o.aZ)({__name:"SectionSVG",props:{showSyntenyOnHover:{type:Boolean},showStartStop:{type:Boolean},showChromosome:{type:Boolean},selectOnClick:{type:Boolean},region:null,syntenyHoverSvgY:null,geneList:null},emits:["synteny-hover"],setup:function(e,t){var n=t.emit,a=e,i="#FF7C60",s="#FF4822",r=10,l=(0,S.oR)(w.J),c=W(),u=c.getBasePairPositionFromMouseEvent,p=c.getBasePairPositionFromSVG,v=c.mouseYPos,h=F(l),b=h.setHoverOnGeneLinesAndDatatrackSections,m=h.onDatatrackSectionClick;(0,g.BK)(a);var k=(0,g.iH)("");(0,o.bv)((function(){q(l.state.selectedGeneIds)})),(0,o.YP)([function(){return l.state.selectedGeneIds},function(){return a.region}],(function(){q(l.state.selectedGeneIds)})),(0,o.YP)((function(){return a.syntenyHoverSvgY}),(function(){G.value||null==a.syntenyHoverSvgY||K(a.syntenyHoverSvgY)}));var Z=(0,g.Fl)((function(){return a.region.syntenyBlocks.filter((function(e){return 1===e.chainLevel}))})),B=(0,g.Fl)((function(){return a.region.syntenyBlocks.filter((function(e){return 2===e.chainLevel}))})),D=(0,g.Fl)((function(){return a.region.syntenyGaps.filter((function(e){return 1===e.chainLevel}))})),U=(0,g.Fl)((function(){return a.region.syntenyGaps.filter((function(e){return 2===e.chainLevel}))})),C=(0,g.Fl)((function(){return a.region.datatrackSets})),G=(0,g.Fl)((function(){return a.region.syntenyBlocks.some((function(e){return e.isHovered}))})),_=(0,g.Fl)((function(){return null!=a.syntenyHoverSvgY&&null!=v.value&&!a.showStartStop&&(G.value||""!==k.value)})),Y=function(e,t){if(e.isHovered=!0,"qtl"!==e.type){var n=l.state.selectedGeneIds.length>0,a=[];if("gene"===e.type){var o=e;if(b(null===o||void 0===o?void 0:o.lines,!0),!n)if(o.lines.length>0){var i=(0,A.XK)(o.lines[0]),s=i.selectedData;a.push.apply(a,(0,d.Z)(s))}else a.push(new y.Z(o.gene.clone(),"Gene"))}else n||("variant"===e.type?a.push(new y.Z(e,"variantDensity")):a.push(new y.Z(e,t)));a.length>0&&l.dispatch("setSelectedData",a)}},I=function(e){if(n("synteny-hover",null),k.value="",e&&(e.isHovered=!1),0===l.state.selectedGeneIds.length&&l.dispatch("setSelectedData",null),"gene"===e.type){var t=e;b(t.lines,!1)}},H=function(e){var t=l.state.selectedBackboneRegion,n=l.state.chromosome;if(n&&e.backboneAlignment){var a=e.backboneAlignment.start,o=e.backboneAlignment.stop;t.setViewportSelection(a,o),l.dispatch("setDetailedBasePairRequest",{start:a,stop:o})}},X=function(e){return e.isSelected?s:e.isHovered?i:e.elementColor},R=function(e){return"variant"===e.type?"block-section variant":"block-section"},q=function(e){C.value.forEach((function(t){t.datatracks&&t.datatracks.length>0&&"gene"===t.datatracks[0].type&&t.datatracks.forEach((function(t){null!=t.gene&&(e.includes(t.gene.rgdId)?t.isSelected=!0:t.isSelected=!1)}))})),a.region.orthologLines.forEach((function(t){e.includes(t.backboneGene.rgdId||-1)||e.includes(t.offBackboneGene.rgdId||-1)?(t.isSelected=!0,t.backboneGeneDatatrack&&(t.backboneGeneDatatrack.isSelected=!0),t.offBackboneGeneDatatrack&&(t.offBackboneGeneDatatrack.isSelected=!0)):t.isSelected=!1}))},E=function(e){var t=x.ef-e.posY1,n=e.length/e.height,a=e.isInverted?e.speciesStart-t*n:e.speciesStart+t*n;return P.M.convertBasePairToLabel(Math.round(a))},O=function(e){var t=e.posY2-x.lv,n=e.length/e.height,a=e.isInverted?e.speciesStop+t*n:e.speciesStop-t*n;return P.M.convertBasePairToLabel(Math.round(a))},V=function(e,t){var a,o=u(e,t.posY1,t.posY2,t.speciesStart,t.speciesStop);(k.value=P.M.convertBasePairToLabel(o)||"",G.value)&&n("synteny-hover",null!==(a=v.value)&&void 0!==a?a:null)},N=function(e){if(a.region.gaplessBlock.posY1<=e&&a.region.gaplessBlock.posY2>=e)for(var t=0;t<a.region.syntenyBlocks.length;t++){var n=a.region.syntenyBlocks[t];if(n.posY1<=e&&n.posY2>=e)return n}return null},K=function(e){var t=N(e);if(null!=t){var n=p(e,t.posY1,t.posY2,t.speciesStart,t.speciesStop);k.value=P.M.convertBasePairToLabel(n)||""}else k.value=""};return function(t,n){return(0,o.wg)(),(0,o.iD)(o.HY,null,[e.showStartStop&&e.region.gaplessBlock.startLabel.isVisible?((0,o.wg)(),(0,o.j4)(z,{key:0,"gapless-block":e.region.gaplessBlock},null,8,["gapless-block"])):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,g.SU)(D),(function(e,t){return(0,o.wg)(),(0,o.j4)(T,{key:t,"gap-section":e},null,8,["gap-section"])})),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,g.SU)(U),(function(e,t){return(0,o.wg)(),(0,o.j4)(T,{key:t,"gap-section":e},null,8,["gap-section"])})),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,g.SU)(Z),(function(t,n){return(0,o.wg)(),(0,o.iD)(o.HY,{key:n},[(0,o._)("rect",{class:"block-section",onMouseenter:function(e){return Y(t,"trackSection")},onMouseleave:function(e){return I(t)},onMousemove:function(e){return V(e,t)},onClick:function(n){return e.selectOnClick?H(t):function(){}},y:t.posY1,x:t.posX1,width:t.width,height:t.height,fill:X(t),"fill-opacity":1},null,40,j),e.showChromosome?((0,o.wg)(),(0,o.j4)(L,{key:0,"synteny-section":t},null,8,["synteny-section"])):(0,o.kq)("",!0)],64)})),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,g.SU)(B),(function(t,n){return(0,o.wg)(),(0,o.iD)(o.HY,{key:n},[(0,o._)("rect",{class:"level-2 block-section",onMouseenter:function(e){return Y(t,"trackSection")},onMouseleave:function(e){return I(t)},onMousemove:function(e){return V(e,t)},y:t.posY1,x:t.posX1,width:t.width,height:t.height,fill:X(t),"fill-opacity":1},null,40,J),e.showChromosome?((0,o.wg)(),(0,o.j4)(L,{key:0,"synteny-section":t},null,8,["synteny-section"])):(0,o.kq)("",!0)],64)})),128)),e.region&&e.showSyntenyOnHover?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:1},(0,o.Ko)(e.region.syntenyBlocks,(function(e,t){return(0,o.wg)(),(0,o.j4)(M,{key:t,"synteny-section":e},null,8,["synteny-section"])})),128)):(0,o.kq)("",!0),!e.showStartStop&&e.region.gaplessBlock.startLabel.isVisible&&e.region.gaplessBlock.height>10&&e.region.syntenyBlocks.some((function(e){return e.isHovered}))?((0,o.wg)(),(0,o.iD)(o.HY,{key:2},[e.region.gaplessBlock.posY1<(0,g.SU)(x.ef)&&e.region.gaplessBlock.posY2>(0,g.SU)(x.ef)?((0,o.wg)(),(0,o.iD)("text",{key:0,class:"label small",x:e.region.gaplessBlock.posX1-r,y:(0,g.SU)(x.ef)+10},(0,f.zw)(E(e.region.gaplessBlock)),9,Q)):((0,o.wg)(),(0,o.iD)("text",{key:1,class:"label small","dominant-baseline":"hanging",x:e.region.gaplessBlock.posX1-r,y:e.region.gaplessBlock.posY1},(0,f.zw)(e.region.gaplessBlock.startLabel.text),9,$)),e.region.gaplessBlock.posY2>(0,g.SU)(x.lv)&&e.region.gaplessBlock.posY1<(0,g.SU)(x.lv)?((0,o.wg)(),(0,o.iD)("text",{key:2,class:"label small",x:e.region.gaplessBlock.posX1-r,y:(0,g.SU)(x.lv)-10},(0,f.zw)(O(e.region.gaplessBlock)),9,ee)):((0,o.wg)(),(0,o.iD)("text",{key:3,class:"label small","dominant-baseline":"auto",x:e.region.gaplessBlock.posX1-r,y:e.region.gaplessBlock.posY2},(0,f.zw)(e.region.gaplessBlock.stopLabel.text),9,te))],64)):(0,o.kq)("",!0),(0,g.SU)(_)?((0,o.wg)(),(0,o.iD)(o.HY,{key:3},[(0,o._)("text",{class:"label small","text-anchor":"end","dominant-baseline":"middle",x:e.region.gaplessBlock.posX1-1,y:(0,g.SU)(v)},(0,f.zw)(k.value),9,ne),(0,o._)("line",{class:"position-label",x1:e.region.gaplessBlock.posX1,x2:e.region.gaplessBlock.posX1+e.region.gaplessBlock.width,y1:(0,g.SU)(v),y2:(0,g.SU)(v)},null,8,ae)],64)):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,g.SU)(C),(function(t,n){return(0,o.wg)(),(0,o.iD)(o.HY,{key:n},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.datatracks,(function(n,a){return(0,o.wg)(),(0,o.iD)("rect",{key:a,class:(0,f.C_)(R(t)),onMouseenter:function(e){return Y(n,"Gene")},onMouseleave:function(e){return I(n)},onClick:function(t){return(0,g.SU)(m)(t,n,e.geneList)},y:n.posY1,x:n.posX1,width:n.width,height:n.height,fill:X(n),"fill-opacity":n.opacity,stroke:X(n)},null,42,oe)})),128))],64)})),128))],64)}}}),se=(0,s.Z)(ie,[["__scopeId","data-v-ef073d0a"]]),re=se;var le=n(9811),ce=(n(6755),["x","y"]);const ue=(0,o.aZ)({__name:"GeneLabelSVG",props:{label:null,geneList:null,orthologLines:null},setup:function(e){var t=(0,S.oR)(w.J),n=F(t),a=n.onGeneLabelClick,i=function(e){var n=e.genes.length,a=t.state.selectedGeneIds,o=e.text;if(!a.includes(e.mainGene.rgdId)&&a.some((function(t){return e.rgdIds.includes(t)}))){for(var i=e.genes.filter((function(e){return a.includes(e.rgdId)})),s=0;s<i.length;s++)if(o=c(i[s].symbol,n),!o.startsWith("LOC"))break}else n>1?o=c(e.text,n):o.length>9&&(o=e.text.substring(0,10)+"...");return o},s=function(e){if(e.isHovered=!0,0===t.state.selectedGeneIds.length){var n=e.genes.map((function(e){return new y.Z(e.clone(),"Gene")}));t.dispatch("setSelectedData",n)}},r=function(e){e.isHovered=!1,0===t.state.selectedGeneIds.length&&t.dispatch("setSelectedData",null)},l=function(e){var n=t.state.selectedGeneIds,a=e.rgdIds;return n.some((function(e){return a.includes(e)}))||e.isHovered},c=function(e,t){var n=t>9?e.substring(0,7):e.substring(0,8);return"".concat(n,"...(").concat(t,")")};return function(t,n){return(0,o.wg)(),(0,o.iD)("text",{onClick:n[0]||(n[0]=function(t){return(0,g.SU)(a)(t,e.label,e.geneList,e.orthologLines)}),onMouseenter:n[1]||(n[1]=function(t){return s(e.label)}),onMouseleave:n[2]||(n[2]=function(t){return r(e.label)}),class:(0,f.C_)(l(e.label)?"bold-label":"label small"),x:e.label.posX+5,y:e.label.posY,"dominant-baseline":"middle","text-anchor":"start"},(0,f.zw)(i(e.label)),43,ce)}}}),de=(0,s.Z)(ue,[["__scopeId","data-v-b354cb24"]]),pe=de;var ve=n(8451),he=["width","height"],ge=["x","width","height"],be=["x","y"],fe=["x","y"],me=["x","y"],ke=["x","y"],Se=["x","y"],ye=["x","y","transform"],we=["x","y"],Pe=["x","y","transform"];const Ze=(0,o.aZ)({__name:"ViewboxTitlesSVG",props:{overviewBackboneSet:null,overviewSyntenySets:null,detailedBackboneSet:null,detailedSyntenySets:null},setup:function(e){var t=-30;function n(e,t,n){return"rotate(".concat(e," ").concat(t," ").concat(n,")")}function a(e,t){var n=(0,ve.uc)(e,t),a=n+x.ZP.dataTrackWidth/2;return a}return function(i,s){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("rect",{class:"panel",x:"0",width:(0,g.SU)(x.ZP).overviewPanelWidth,height:(0,g.SU)(x.ZP).panelTitleHeight},null,8,he),(0,o._)("rect",{class:"panel",x:(0,g.SU)(x.ZP).overviewPanelWidth,width:(0,g.SU)(x.ZP).detailsPanelWidth,height:(0,g.SU)(x.ZP).panelTitleHeight},null,8,ge),(0,o._)("text",{class:"label medium bold",x:(0,g.SU)(x.ZP).overviewTitleXPosition,y:(0,g.SU)(x.ZP).panelTitleYPosition},"Overview",8,be),(0,o._)("text",{class:"label medium bold",x:(0,g.SU)(x.ZP).selectedBackboneXPosition-5,y:(0,g.SU)(x.ZP).panelTitleYPosition},"Detailed",8,fe),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.overviewSyntenySets,(function(e,t){return(0,o.wg)(),(0,o.iD)(o.HY,{key:t},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.titleLabels,(function(e,t){return(0,o.wg)(),(0,o.iD)("text",{key:t,class:(0,f.C_)("label small ".concat(e.addClass)),x:e.posX,y:e.posY},(0,f.zw)(e.text),11,me)})),128))],64)})),128)),e.overviewBackboneSet?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:0},(0,o.Ko)(e.overviewBackboneSet.titleLabels,(function(e,t){return(0,o.wg)(),(0,o.iD)("text",{key:t,class:(0,f.C_)("label small ".concat(e.addClass)),x:e.posX,y:e.posY},(0,f.zw)(e.text),11,ke)})),128)):(0,o.kq)("",!0),e.detailedBackboneSet?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.detailedBackboneSet.titleLabels,(function(e,t){return(0,o.wg)(),(0,o.iD)("text",{key:t,class:(0,f.C_)("label small ".concat(e.addClass)),x:e.posX-5,y:e.posY},(0,f.zw)(e.text),11,Se)})),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.detailedBackboneSet.datatrackSets,(function(e,a){return(0,o.wg)(),(0,o.iD)(o.HY,{key:a},[e.datatracks.length>0?((0,o.wg)(),(0,o.iD)("text",{key:0,class:"label small",x:(e.datatracks[0].posX1+e.datatracks[0].posX2)/2,y:(0,g.SU)(x.ZP).panelTitleHeight-20,transform:n(t,(e.datatracks[0].posX1+e.datatracks[0].posX2)/2,(0,g.SU)(x.ZP).panelTitleHeight-20)},(0,f.zw)(e.getTrackTypeDisplayName()),9,ye)):(0,o.kq)("",!0)],64)})),128))],64)):(0,o.kq)("",!0),e.detailedSyntenySets.length?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:2},(0,o.Ko)(e.detailedSyntenySets,(function(e,i){return(0,o.wg)(),(0,o.iD)(o.HY,{key:i},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.titleLabels,(function(e,t){return(0,o.wg)(),(0,o.iD)("text",{key:t,class:(0,f.C_)("label small ".concat(e.addClass)),x:e.posX-5,y:e.posY},(0,f.zw)(e.text),11,we)})),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.regions[0].datatrackSets,(function(i,s){return(0,o.wg)(),(0,o.iD)("text",{key:s,class:"label small",x:a(e.order,s),y:(0,g.SU)(x.ZP).panelTitleHeight-20,transform:n(t,a(e.order,s),(0,g.SU)(x.ZP).panelTitleHeight-20)},(0,f.zw)(i.getTrackTypeDisplayName()),9,Pe)})),128))],64)})),128)):(0,o.kq)("",!0)],64)}}}),Be=(0,s.Z)(Ze,[["__scopeId","data-v-3f7ac275"]]),De=Be;var Le=n(1947);function xe(){var e=(0,Le.wL)(),t=(0,g.iH)(!1),n=(0,g.iH)(""),a=(0,g.iH)(""),o=(0,g.iH)(!1),i=(0,g.iH)("normal"),s=function(s,r,l,c){e.error(s),n.value=null!==c&&void 0!==c?c:"Error",a.value=r,o.value=l,i.value="error",t.value=!0};return{onError:s,dialogHeader:n,dialogMessage:a,showDialog:t,showDialogBackButton:o,dialogTheme:i}}function Ue(e){var t,n,a=(0,Le.wL)(),i=!1,s=(0,g.iH)(),r=(0,g.iH)();(0,o.bv)((function(){n=document.querySelector("svg")}));var l=function(){return i},c=function(o,r){if(!(e.state.isOverviewPanelUpdating||e.state.isDetailedPanelUpdating||r)){var l=e.state.selectedBackboneRegion;if(!l||l.viewportSelection)return i?void v():(i=!0,t=N(n,o),void(s.value=t.y));a.warn("Cannot zoom on the detailed panel without a selection in the overview")}},u=function(o){e.state.isOverviewPanelUpdating||e.state.isDetailedPanelUpdating||(e.state.detailedBasePairRange?(i=!0,t=N(n,o),s.value=t.y):a.warn("Cannot zoom on the detailed panel without a selection in the overview"))},d=function(e){if(i){var a=N(n,e);a.y<t.y?(s.value=a.y,r.value=t.y):r.value=a.y}},p=function(){i&&(i=!1,s.value=void 0,r.value=void 0)},v=function(){if(i){i=!1;var t=e.state.selectionToastCount;if(null!=s.value&&null!=r.value&&e.state.detailedBasePairRange){var n=x.lv-x.ef,o=Math.abs(e.state.detailedBasePairRange.stop-e.state.detailedBasePairRange.start),l=n/o,c=Math.floor((s.value-x.ZP.panelTitleHeight)/l)+e.state.detailedBasePairRange.start,u=Math.floor((r.value-x.ZP.panelTitleHeight)/l)+e.state.detailedBasePairRange.start;a.log("Requesting zoom to (".concat(c,", ").concat(u,") from Y:(").concat(s.value,", ").concat(r.value,")")),e.dispatch("setSelectionToastCount",t+1),e.dispatch("setDetailedBasePairRequest",{start:c,stop:u})}s.value=void 0,r.value=void 0}};return{detailedSelectionHandler:c,startDetailedSelectionY:s,stopDetailedSelectionY:r,initZoomSelection:u,updateZoomSelection:d,cancelDetailedSelection:p,completeZoomSelection:v,getDetailedSelectionStatus:l}}var Ce=n(3087),Ge=n(2833),_e=(n(2707),function(){function e(t,n){(0,Ce.Z)(this,e),this.datatracks=[],this.datatracks=t,this.type=n}return(0,Ge.Z)(e,[{key:"addDatatrackSections",value:function(e){this.datatracks=this.datatracks.concat(e)}},{key:"clearDatatrackSections",value:function(){this.datatracks.splice(0,this.datatracks.length)}},{key:"getTrackTypeDisplayName",value:function(){switch(this.type){case"gene":return"Genes";case"variant":return"Variants"}}}]),e}()),Me=n(5556),Ye=function(){function e(t){(0,Ce.Z)(this,e),this.syntenyGaps=[],this.syntenyBlocks=[],this.datatrackSets=[],this.orthologLines=[],this.species="",this.mapName="",this.geneDatatrackLabels=[],this.genes=[],this.species=t.species,this.mapName=t.mapName,this.gaplessBlock=t.gaplessBlock,this.genes=t.genes?t.genes.map((function(e){return e.clone()})):[]}return(0,Ge.Z)(e,[{key:"addSyntenyGaps",value:function(e){this.syntenyGaps.length>0?this.syntenyGaps=this.syntenyGaps.concat(e):this.syntenyGaps=e,this.syntenyGaps.sort((function(e,t){return e.posY1-t.posY1}))}},{key:"addSyntenyBlocks",value:function(e){this.syntenyBlocks.length>0?this.syntenyBlocks=this.syntenyBlocks.concat(e):this.syntenyBlocks=e,this.syntenyBlocks.sort((function(e,t){return e.posY1-t.posY1}))}},{key:"addDatatrackSections",value:function(e,t,n){this.datatrackSets[t]&&this.datatrackSets[t].datatracks.length>0?this.datatrackSets[t].addDatatrackSections(e):this.datatrackSets[t]=new _e(e,n)}},{key:"splitBlockWithGaps",value:function(e,t){var n=this;Me.Z.time("Sort gaps for splitBlockWithGaps");var a=(0,d.Z)(t).filter((function(e){return e.chainLevel===n.gaplessBlock.chainLevel&&(0,ve.Oo)(e,n.gaplessBlock.windowBasePairRange.start,n.gaplessBlock.windowBasePairRange.stop)})).sort((function(e,t){return e.backboneStart-t.backboneStart}));Me.Z.timeEnd("Sort gaps for splitBlockWithGaps"),Me.Z.log(" splitBlockWithGaps: filtered ".concat(t.length," down gaps to ").concat(a.length)),this.syntenyBlocks=[],this.syntenyGaps=[];var o=this.gaplessBlock,i=e.createSyntenySection({start:o.speciesStart,stop:o.speciesStop,backboneAlignment:o.backboneAlignment,type:"gap",orientation:"+",chainLevel:o.chainLevel});if(this.syntenyGaps.push(i),0!==a.length){var s=0,r=0;a.forEach((function(a,i){var l=o.backboneAlignment.start,c=a.backboneStart,u=o.isInverted?a.stop:a.start,d=o.isInverted?a.start:a.stop;if(0===i&&c<=l)s=a.backboneStop,r=d;else if(0===i){var p=e.createSyntenySection({start:o.speciesStart,stop:u,backboneAlignment:{start:o.backboneAlignment.start,stop:a.backboneStart},type:"block",orientation:o.orientation,chainLevel:o.chainLevel});n.syntenyBlocks.push(p),s=a.backboneStop,r=d}else if(s&&r&&a.backboneStart>=s){var v=e.createSyntenySection({start:r,stop:u,backboneAlignment:{start:s,stop:a.backboneStart},type:"block",orientation:o.orientation,chainLevel:o.chainLevel});n.syntenyBlocks.push(v),s=a.backboneStop,r=d}else{var h=t[t.length-1];if(h&&h.backboneStop>a.backboneStart&&h.backboneStop>a.backboneStop)return;var g=e.createSyntenySection({start:h.stop,stop:a.start,backboneAlignment:{start:h.backboneStop,stop:a.backboneStart},type:"block",orientation:o.orientation,chainLevel:o.chainLevel});n.syntenyBlocks.push(g)}}));var l=a[a.length-1];if(l&&l.backboneStop<o.backboneAlignment.stop){var c=e.createSyntenySection({start:o.isInverted?l.start:l.stop,stop:o.speciesStop,backboneAlignment:{start:l.backboneStop,stop:o.backboneAlignment.stop},type:"block",orientation:o.orientation,chainLevel:o.chainLevel});this.syntenyBlocks.push(c)}}else this.syntenyBlocks.push(o)}}]),e}(),Ie=n(3806),He=n(5937),Te=(n(4944),n(3792),(0,Ge.Z)((function e(t,n){var a,o;(0,Ce.Z)(this,e),this.titleLabels=[],this.speciesName=null!==t&&void 0!==t?t:"",this.mapName=null!==(a=null===n||void 0===n?void 0:n.name)&&void 0!==a?a:"",this.mapKey=null!==(o=null===n||void 0===n?void 0:n.key)&&void 0!==o?o:0}))),Xe=(0,Ge.Z)((function e(t){var n,a;(0,Ce.Z)(this,e),this.posX=0,this.posY=0,this.text="",this.isVisible=!0,this.isHovered=!1,this.addClass="",this.posX=t.posX,this.posY=t.posY,this.text=t.text,this.isVisible=null!==(n=t.isVisible)&&void 0!==n?n:this.isVisible,this.addClass=null!==(a=t.addClass)&&void 0!==a?a:this.addClass})),Re=function(e){(0,Ie.Z)(n,e);var t=(0,He.Z)(n);function n(e,a){var o;return(0,Ce.Z)(this,n),o=t.call(this,e),o.genes=a,o.rgdIds=a.map((function(e){return e.rgdId})),o.genes.length>0&&(o.text=o.genes[0].symbol),o}return(0,Ge.Z)(n,[{key:"mainGene",get:function(){var e;return null!==(e=this.genes[0])&&void 0!==e?e:null}}]),n}(Xe),qe=8,Ee="loc";function Oe(e){var t=[];Me.Z.debug(" Merge gene labels [processing ".concat(e.length,"]")),e.sort((function(e,t){return e.posY-t.posY}));for(var n=0;n<e.length;n++){var a=e[n];Math.abs(a.posY-x.ef)<qe&&(a.posY=a.posY+qe);var o=a.gene,i=[];if(n<e.length-1)for(var s=n+1;s<e.length;s++){var r=e[s];if(!Ve(a,r)){n=s-1;break}!r.gene.symbol.toLowerCase().startsWith(Ee)&&(a.gene.symbol.toLowerCase().startsWith(Ee)||a.gene.size<r.gene.size)?(i.push(o),o=r.gene):i.push(r.gene),s===e.length-1&&(n=s)}t.push(new Re({posX:a.posX,posY:a.posY,text:o.symbol,isVisible:!0},[o].concat(i)))}return t}function Ve(e,t){return Math.abs(e.posY-t.posY)<qe}var ze=.75;function Ne(e){return-80*e+x.ZP.backboneXPosition}var We=function(e){(0,Ie.Z)(n,e);var t=(0,He.Z)(n);function n(e,a,o,i,s){var r;return(0,Ce.Z)(this,n),r=t.call(this,e,a),r.regions=[],r.order=1,r.renderType="overview",r.geneLabels=[],r.regions=o,r.order=i,r.renderType=s,r.setRegionXPositionsBasedOnOrder(),r.createTitleLabels(),r.sortBasePairLabels(),"detailed"===s&&(Me.Z.time("Create Gene Labels"),r.generateGeneLabels(),Me.Z.timeEnd("Create Gene Labels")),r}return(0,Ge.Z)(n,[{key:"generateGeneLabels",value:function(){for(var e=null,t=null,n=null,a=0;a<this.regions.length;a++){null!=t&&null!=n||(t=this.regions[a].gaplessBlock.windowStart,n=this.regions[a].gaplessBlock.windowStop);for(var o=0;o<this.regions[a].datatrackSets.length;o++)if("gene"===this.regions[a].datatrackSets[o].type){e=(0,ve.uc)(this.order,o)+x.ZP.dataTrackWidth;break}if(null!=e&&null!=t&&null!=n)break}if(null==e||null==t||null==n)return Me.Z.debug("(SyntenyRegionSet) generateGeneLabels: xPos || visibleBackboneStart || visibleBackboneStop is null after iterating through DatatrackSets"),void Me.Z.debug("  ".concat(e,", ").concat(t,", ").concat(n));var i=this.regions.map((function(e){return e.genes})).flat().filter((function(e){return(0,ve.Oo)(e,t,n)}));Me.Z.time("Create intermediate labels");for(var s=[],r=0;r<i.length;r++){var l=i[r],c=(0,ve.f_)(l.backboneStart,l.backboneStop,t,n);s.push({gene:l,posY:c,posX:e})}Me.Z.timeEnd("Create intermediate labels"),this.geneLabels=Oe(s)}},{key:"addRegions",value:function(e){this.regions.length>0?this.regions=this.regions.concat(e):this.regions=e,this.setRegionXPositionsBasedOnOrder()}},{key:"createTitleLabels",value:function(){var e=new Xe({posX:"overview"===this.renderType?Ne(this.order):(0,ve.qN)(this.order),posY:x.ZP.trackLabelYPosition,text:this.speciesName}),t=new Xe({posX:"overview"===this.renderType?Ne(this.order):(0,ve.qN)(this.order),posY:x.ZP.trackMapLabelYPosition,text:this.mapName,addClass:"smaller"});this.titleLabels=[e,t]}},{key:"setRegionXPositionsBasedOnOrder",value:function(){var e=this;this.regions.length>0&&this.regions.forEach((function(t){e.setGaplessSyntenyBlockXPositions(t.gaplessBlock),e.setSyntenyBlockXPositions(t.syntenyBlocks),e.setSyntenyGapXPositions(t.syntenyGaps),e.setDatatrackSectionXPositions(t.datatrackSets)}))}},{key:"setSyntenyGapXPositions",value:function(e){var t=this;e.forEach((function(e){var n=0;"overview"===t.renderType?n=Ne(t.order):"detailed"===t.renderType&&(n=(0,ve.qN)(t.order));var a=n+x.ZP.trackWidth/2;e.posX1=a,e.posX2=a,e.width=0}))}},{key:"setSyntenyBlockXPositions",value:function(e){var t=this;e.forEach((function(e){"overview"===t.renderType?e.posX1=Ne(t.order):"detailed"===t.renderType&&(e.posX1=(0,ve.qN)(t.order));var n=x.ZP.trackWidth;2===e.chainLevel&&(e.posX1=e.posX1+x.ZP.trackWidth*(1-ze)/2,n*=ze),e.posX2=e.posX1+n,e.width=Math.abs(e.posX2-e.posX1)}))}},{key:"setGaplessSyntenyBlockXPositions",value:function(e){this.setSyntenyBlockXPositions([e]),e.startLabel.posX=e.posX2,e.stopLabel.posX=e.posX2}},{key:"setDatatrackSectionXPositions",value:function(e){var t=this;e.forEach((function(e,n){var a=0;"overview"===t.renderType?a=Ne(t.order):"detailed"===t.renderType&&(a=(0,ve.uc)(t.order,n)),e.datatracks.forEach((function(e){e.posX1=a,e.posX2=e.posX1+x.ZP.dataTrackWidth,e.label&&(e.label.posX=e.posX2),e.width=Math.abs(e.posX2-e.posX1)}))}))}},{key:"sortBasePairLabels",value:function(){var e=Ne(this.order)+x.ZP.trackWidth,t=this.regions.map((function(e){return{startLabel:e.gaplessBlock.startLabel,stopLabel:e.gaplessBlock.stopLabel}}));t.sort((function(e,t){return Math.abs(t.startLabel.posY-t.stopLabel.posY)-Math.abs(e.startLabel.posY-e.stopLabel.posY)}));for(var n=0;n<t.length;n++){var a=t[n];a.startLabel.posX=e,a.stopLabel.posX=e,Math.abs(a.stopLabel.posY-a.startLabel.posY)>14&&(a.startLabel.isVisible=!0,a.stopLabel.isVisible=!0)}}},{key:"geneDatatrackSetIndex",get:function(){for(var e=0;e<this.regions.length;e++)for(var t=0;t<this.regions[e].datatrackSets.length;t++)if("gene"===this.regions[e].datatrackSets[t].type)return t;return 0}}]),n}(Te),Ae=(n(9714),function(){function e(t){(0,Ce.Z)(this,e),this.posX1=0,this.posX2=0,this.posY1=0,this.posY2=0,this.height=0,this.width=0,this.shape="rect",this.representation="",this.isHovered=!1,this.isSelected=!1,this.elementColor="",this.opacity=1,this.speciesStart=0,this.speciesStop=0,this.type="block",this.speciesName=t.speciesName,this.mapName=t.mapName,this.chromosome=t.chromosome,this.speciesStart=t.start,this.speciesStop=t.stop,this.type=t.type,this.backboneAlignment=t.backboneAlignment,this.windowBasePairRange=t.windowBasePairRange,this.renderType=t.renderType,this.calculateYPositionsBasedOnBackboneAlignment(),this.elementColor=t.color,"block"===t.type||"gene"===t.type||"qtl"===t.type?this.shape="rect":this.shape="line"}return(0,Ge.Z)(e,[{key:"length",get:function(){return Math.abs(this.speciesStop-this.speciesStart)}},{key:"backboneAlignmentLength",get:function(){return Math.abs(this.backboneAlignment.stop-this.backboneAlignment.start)}},{key:"blockRatio",get:function(){return Math.abs(this.backboneAlignment.stop-this.backboneAlignment.start)/this.length}},{key:"windowSVGStart",get:function(){return"overview"===this.renderType?x.ef+x.ZP.overviewTrackPadding:x.ef}},{key:"windowSVGStop",get:function(){return"overview"===this.renderType?x.lv-x.ZP.overviewTrackPadding:x.lv}},{key:"windowSVGMiddle",get:function(){return this.windowSVGStart+(this.windowSVGStop-this.windowSVGStart)/2}},{key:"windowStart",get:function(){return this.windowBasePairRange.start}},{key:"windowStop",get:function(){return this.windowBasePairRange.stop}},{key:"adjustYPositionsBasedOnVisibleStartAndStop",value:function(e){this.windowBasePairRange=e,this.calculateYPositionsBasedOnBackboneAlignment()}},{key:"calculateYPositionsBasedOnBackboneAlignment",value:function(){var e=this.windowSVGStop,t=this.windowSVGStart,n=this.windowStop,a=this.windowStart,o=e-t,i=Math.abs(n-a),s=i/o,r=Math.abs(a-this.backboneAlignment.start),l=r/s;this.backboneAlignment.start<a?this.posY1=t-l:this.backboneAlignment.start>a?this.posY1=t+l:this.backboneAlignment.start===a&&(this.posY1=t),this.posY2=this.posY1+this.backboneAlignmentLength/s,this.height=Math.abs(this.posY2-this.posY1)}}]),e}()),Ke=function(e){(0,Ie.Z)(n,e);var t=(0,He.Z)(n);function n(e){return(0,Ce.Z)(this,n),t.call(this,e)}return(0,Ge.Z)(n)}(Ae),Fe=function(e){(0,Ie.Z)(n,e);var t=(0,He.Z)(n);function n(e,a,o,i,s,r,l,c,u){var d;return(0,Ce.Z)(this,n),d=t.call(this,{start:a,stop:o,backboneAlignment:i,speciesName:s,mapName:r,chromosome:l,windowBasePairRange:c,renderType:u,type:"gene",color:"#00000"}),d.lines=[],d.gene=e.clone(),d.opacity=.7,d}return(0,Ge.Z)(n)}(Ke),je=function(e){(0,Ie.Z)(n,e);var t=(0,He.Z)(n);function n(e,a,o,i,s,r,l,c,u,d){var p;return(0,Ce.Z)(this,n),p=t.call(this,{start:o,stop:i,backboneAlignment:s,speciesName:r,mapName:l,chromosome:c,windowBasePairRange:u,renderType:d,type:"variant",color:"#FFFFFF"}),p.variantCount=e,0!==a&&p.setSectionColor(a),p}return(0,Ge.Z)(n,[{key:"setSectionColor",value:function(e){var t=Math.round((e-this.variantCount)/e*255),n=Math.round(this.variantCount/e*255),a=n.toString(16);a=1===a.length?"0".concat(a):a;var o=t.toString(16);o=1===o.length?"0".concat(o):o,this.elementColor="#".concat(a,"00").concat(o)}}]),n}(Ke),Je=n(9644),Qe=function(e){(0,Ie.Z)(n,e);var t=(0,He.Z)(n);function n(e){var a;return(0,Ce.Z)(this,n),a=t.call(this,{speciesName:e.speciesName,mapName:e.mapName,start:e.start,stop:e.stop,type:e.type,color:Je.Z.getColor(e.chromosome),backboneAlignment:e.backboneAlignment,windowBasePairRange:e.windowBasePairRange,renderType:e.renderType,chromosome:e.chromosome}),a.threshold=0,a.orientation="+",a.chainLevel=0,a.isInverted=!1,a.orientation=e.orientation,a.isInverted="-"===e.orientation,a.chainLevel=e.chainLevel,e.isGapless&&a.createSyntenySectionLabels(),a}return(0,Ge.Z)(n,[{key:"createSyntenySectionLabels",value:function(){this.startLabel=new Xe({posX:this.posX2,posY:this.posY1,text:P.M.convertBasePairToLabel(this.speciesStart)||"",isVisible:!1}),this.stopLabel=new Xe({posX:this.posX2,posY:this.posY2,text:P.M.convertBasePairToLabel(this.speciesStop)||"",isVisible:!1})}}]),n}(Ae),$e=function(){function e(t,n,a,o,i){(0,Ce.Z)(this,e),this.speciesName=t,this.mapName=n,this.chromosome=a,this.windowBasePairRange=o,this.renderType=i}return(0,Ge.Z)(e,[{key:"createSyntenySection",value:function(e){var t=e.start,n=e.stop,a=e.backboneAlignment,o=e.type,i=e.orientation,s=e.chainLevel,r=e.isGapless;return new Qe({speciesName:this.speciesName,mapName:this.mapName,chromosome:this.chromosome,windowBasePairRange:this.windowBasePairRange,renderType:this.renderType,start:t,stop:n,backboneAlignment:a,type:o,orientation:i,chainLevel:s,isGapless:r})}},{key:"createGeneDatatrackSection",value:function(e){var t=e.gene,n=e.start,a=e.stop,o=e.backboneAlignment;return new Fe(t,n,a,o,this.speciesName,this.mapName,this.chromosome,this.windowBasePairRange,this.renderType)}},{key:"createVariantDensitySection",value:function(e,t,n,a,o){return new je(e,t,n,a,o,this.speciesName,this.mapName,this.chromosome,this.windowBasePairRange,this.renderType)}}]),e}(),et=(n(3290),(0,Ge.Z)((function e(t){var n;(0,Ce.Z)(this,e),this.speciesName="",this.chromosome="",this.positions=[],this.mapKey=t.mapKey,this.speciesName=null!==(n=t.speciesName)&&void 0!==n?n:this.speciesName,this.chromosome=t.chromosome,this.positions=t.positions,this.blockStart=t.blockStart,this.blockStop=t.blockStop,this.backboneStart=t.backboneStart,this.backboneStop=t.backboneStop}))),tt=n(7577),nt=function(){function e(){(0,Ce.Z)(this,e)}return(0,Ge.Z)(e,null,[{key:"getVariants",value:function(){var e=(0,h.Z)((0,v.Z)().mark((function e(t,n,a,o){var i;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,tt.Z.get("/vcmap/variants/position/".concat(t,"/").concat(n,"/").concat(a,"/").concat(o));case 2:return i=e.sent,e.abrupt("return",i.data);case 4:case"end":return e.stop()}}),e)})));function t(t,n,a,o){return e.apply(this,arguments)}return t}()}]),e}(),at=100,ot=1e4;function it(e,t,n,a,o,i,s,r){for(var l=a-n,c=e.windowBasePairRange.start,u=e.windowBasePairRange.stop,d=Math.max(Math.round((u-c)/at),ot),p=Math.round((i-o)/l*d),v=Math.max(Math.round(l/d),1),h=new Array(v).fill(0),g=n,b=0;b<t.length;b++){var f=Math.min(Math.floor((t[b]-n)/d),v-1);h[f]++}var m=ct(h),k=[],S=0,y=0;s?y=i:S=o,g=n;for(var w=0;w<h.length;w++){var P=Math.min(g+d,a);s?S=Math.max(y-p,o):y=Math.min(S+p,i);var Z=dt(g,P,S,y,c,u,r);if(ut(Z.start,Z.stop,c,u)){var B=e.createVariantDensitySection(h[w],m,g,P,Z);B.adjustYPositionsBasedOnVisibleStartAndStop(e.windowBasePairRange),k.push(B)}g+=d,s?y-=p:S+=p}return{datatracks:k,maxCount:m,binSize:d}}function st(e,t,n,a,o,i){return rt.apply(this,arguments)}function rt(){return rt=(0,h.Z)((0,v.Z)().mark((function e(t,n,a,o,i,s){var r;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,nt.getVariants(t,n,a,s);case 2:return r=e.sent,e.abrupt("return",new et({mapKey:s,chromosome:t,positions:r,blockStart:n,blockStop:a,backboneStart:o,backboneStop:i}));case 4:case"end":return e.stop()}}),e)}))),rt.apply(this,arguments)}function lt(e,t,n){var a=new $e(e.name,e.activeMap.name,n.chromosome,n.windowBasePairRange,n.renderType),o=it(a,t.positions,t.backboneStart,t.backboneStop,t.backboneStart,t.backboneStop,!1);return o}function ct(e){for(var t=0,n=0;n<e.length;n++)e[n]>t&&(t=e[n]);return t}function ut(e,t,n,a){return e>n&&e<a||t<a&&t>n||e<n&&t>a}function dt(e,t,n,a,o,i,s){return s?ut(s.backboneStart,s.backboneStop,o,i)?(0,ve.uZ)(e,t,s):(0,ve.go)(e,t,s):{start:n,stop:a}}function pt(e,t,n){return vt.apply(this,arguments)}function vt(){return vt=(0,h.Z)((0,v.Z)().mark((function e(t,n,a){var o,i;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=[],i=1,t.forEach((function(e,t){var s=n.find((function(e){return e.activeMap.key==t}));if(s){for(var r=[],l=0;l<e.length;l++){var c=e[l],u=c.chromosome.chromosome,d=new $e(s.name,s.activeMap.name,u,{start:0,stop:a.seqLength},"overview"),p=d.createSyntenySection({start:"-"===c.orientation?c.stop:c.start,stop:"-"===c.orientation?c.start:c.stop,backboneAlignment:{start:c.backboneStart,stop:c.backboneStop},type:"block",orientation:c.orientation,chainLevel:c.chainLevel,isGapless:!0}),v=new Ye({species:s.name,mapName:s.activeMap.name,gaplessBlock:p});v.syntenyBlocks.push(p),r.push(v)}o.push(new We(s.name,s.activeMap,r,i,"overview")),i++}})),e.abrupt("return",o);case 4:case"end":return e.stop()}}),e)}))),vt.apply(this,arguments)}function ht(e,t,n,a){return gt.apply(this,arguments)}function gt(){return gt=(0,h.Z)((0,v.Z)().mark((function e(t,n,a,o){var i,s;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=[],t&&t.size>0&&(s=1,t.forEach((function(e,t){var r=n.find((function(e){return e.activeMap.key==t}));if(r){var l=bt(e,r,s,a,o,"detailed");Me.Z.log("Completed build of Synteny for ".concat(null===l||void 0===l?void 0:l.mapName,", with ").concat(null===l||void 0===l?void 0:l.regions.length," regions")),l&&i.push(l),s++}else Me.Z.error("Cannot find Species object for mapKey ".concat(t,"!!"))}))),e.abrupt("return",i);case 3:case"end":return e.stop()}}),e)}))),gt.apply(this,arguments)}function bt(e,t,n,a,o,i){var s=[],r=t,l=e.some((function(e){return e.variantPositions&&e.variantPositions.positions.length>0})),c=0,u=0;Me.Z.debug("About to loop over ".concat(e.length," Blocks..."));for(var d=0;d<e.length;d++){var p=e[d],v=p.gaps,h=p.genes,g=p.chromosome.chromosome,b=p.variantPositions,f=new $e(r.name,r.activeMap.name,g,{start:a,stop:o},i);Me.Z.time("createSyntenySectionAndRegion");var m=f.createSyntenySection({start:"-"===p.orientation?p.stop:p.start,stop:"-"===p.orientation?p.start:p.stop,backboneAlignment:{start:p.backboneStart,stop:p.backboneStop},type:"block",orientation:p.orientation,chainLevel:p.chainLevel,isGapless:!0}),k=new Ye({species:r.name,mapName:r.activeMap.name,gaplessBlock:m,genes:h});if(Me.Z.timeEnd("createSyntenySectionAndRegion"),Me.Z.time("splitBlockWithGaps"),Me.Z.log("Splitting block w/ ".concat(v.length," gaps")),k.splitBlockWithGaps(f,v),Me.Z.timeEnd("splitBlockWithGaps"),b&&l){var S=it(f,b.positions,p.start,p.stop,p.backboneStart,p.backboneStop,p.isBlockInverted(),p);k.addDatatrackSections(S.datatracks,0,"variant"),u=S.binSize,S.maxCount>c&&(c=S.maxCount)}if(h&&h.length>0){Me.Z.time("  filterVisibleGenes");var y=h.filter((function(e){return!(!e.backboneStart||!e.backboneStop)&&(e.backboneStart<=o&&e.backboneStop>=a&&Math.abs(e.backboneStop-e.backboneStart)>=(0,ve.zQ)(o-a))}));Me.Z.timeEnd("  filterVisibleGenes");var w="  syntenicDataTrackBuilder(".concat(y.length,")");Me.Z.time(w);var P=ft(f,y,p.orientation);Me.Z.timeEnd(w),w="  addDatatrackSections(".concat(P.length,")"),Me.Z.time(w);var Z=k.datatrackSets.length;k.addDatatrackSections(P,Z,"gene"),Me.Z.timeEnd(w)}else{var B=k.datatrackSets.length;k.addDatatrackSections([],B,"gene")}s.push(k)}if(l&&c>0)for(var D=0;D<s.length;D++){var L=s[D].datatrackSets.findIndex((function(e){return"variant"===e.type}));-1!==L&&s[D].datatrackSets[L].datatracks.forEach((function(e){e.setSectionColor(c)}))}Me.Z.time("createSyntenyRegionSet");var x=new We(r.name,r.activeMap,s,n,i);return x.maxVariantCount=c,x.variantBinSize=u,Me.Z.timeEnd("createSyntenyRegionSet"),x}function ft(e,t,n){for(var a=[],o=0,i=0,s=0,r=0,l=0,c=t.length;l<c;l++){var u=t[l];if(null!==u.backboneStart&&null!==u.backboneStop){o=performance.now();var d=e.createGeneDatatrackSection({gene:u,start:"-"===n?u.stop:u.start,stop:"-"===n?u.start:u.stop,backboneAlignment:{start:u.backboneStart,stop:u.backboneStop}});s+=performance.now()-o,i=performance.now(),a.push(d),r+=performance.now()-i}else Me.Z.error("Genomic Element ".concat(u.symbol," sent to render without a backbone alignment"))}return Me.Z.debug("    Create total: ".concat(s)),Me.Z.debug("    Push total: ".concat(r)),a}function mt(e){var t,n,a=!1,i=(0,g.iH)(),s=(0,g.iH)();(0,o.bv)((function(){n=document.querySelector("svg")}));var r=function(){return a},l=function(o,s,r){if(!(e.state.isOverviewPanelUpdating||e.state.isDetailedPanelUpdating||s))return a?void p(r):(a=!0,t=N(n,o),void(i.value=t.y))},c=function(o){e.state.isOverviewPanelUpdating||e.state.isDetailedPanelUpdating||(a=!0,t=N(n,o),i.value=t.y)},u=function(e){if(a){var o=N(n,e);o.y<t.y?(i.value=o.y,s.value=t.y):s.value=o.y}},d=function(){a&&(a=!1,i.value=void 0,s.value=void 0)},p=function(t){if(a&&t&&e.state.chromosome){a=!1;var n=e.state.selectionToastCount;if(null!=i.value&&null!=s.value){var o=x.lv-x.ef-2*x.ZP.overviewTrackPadding,r=e.state.chromosome.seqLength,l=o/r,c=Math.floor((i.value-x.ef-x.ZP.overviewTrackPadding)/l),u=Math.floor((s.value-x.ef-x.ZP.overviewTrackPadding)/l);c<0&&(c=0),u>e.state.chromosome.seqLength&&(u=e.state.chromosome.seqLength);var d=e.state.selectedBackboneRegion;d&&d.setViewportSelection&&(d.setViewportSelection(c,u),e.dispatch("setSelectionToastCount",n+1),e.dispatch("setDetailedBasePairRequest",{start:c,stop:u}))}i.value=void 0,s.value=void 0}};return{overviewSelectionHandler:l,startOverviewSelectionY:i,stopOverviewSelectionY:s,initOverviewSelection:c,updateOverviewSelection:u,cancelOverviewSelection:d,completeOverviewSelection:p,getOverviewSelectionStatus:r}}var kt=n(3915),St=n(9201),yt=function(e){(0,Ie.Z)(n,e);var t=(0,He.Z)(n);function n(e){var a,o,i;return(0,Ce.Z)(this,n),i=t.call(this,{speciesName:e.species.name,mapName:e.species.activeMap.name,chromosome:e.chromosome,start:e.start,stop:e.stop,type:"block",color:Je.Z.getColor(null!==(a=e.chromosome)&&void 0!==a?a:""),backboneAlignment:{start:e.start,stop:e.stop},windowBasePairRange:e.windowBasePairRange,renderType:e.renderType}),i.labels=[],i.renderType="overview",i.hasLabels=!1,i.renderType=e.renderType,i.hasLabels=null!==(o=e.createLabels)&&void 0!==o&&o,i.hasLabels&&i.createLabels(),i}return(0,Ge.Z)(n,[{key:"setBackboneGenes",value:function(e){this.backboneGenes=e.map((function(e){return e.clone()}))}},{key:"createLabels",value:function(){var e,t,n,a,o,i;"overview"===this.renderType?(e=new Xe({posX:x.ZP.backboneXPosition-x.ZP.trackWidth/2,posY:this.windowSVGStart-3,text:null!==(n=P.M.convertBasePairToLabel(this.windowStart))&&void 0!==n?n:""}),t=new Xe({posX:x.ZP.backboneXPosition-x.ZP.trackWidth/2,posY:this.windowSVGStop+7,text:null!==(a=P.M.convertBasePairToLabel(this.windowStop))&&void 0!==a?a:""})):(e=new Xe({posX:x.ZP.selectedBackboneXPosition-x.ZP.trackWidth/2,posY:this.windowSVGStart+10,text:null!==(o=P.M.convertBasePairToLabel(this.windowStart))&&void 0!==o?o:""}),t=new Xe({posX:x.ZP.selectedBackboneXPosition-x.ZP.trackWidth/2,posY:this.windowSVGStop-10,text:null!==(i=P.M.convertBasePairToLabel(this.windowStop))&&void 0!==i?i:""}));this.labels=[e,t]}}]),n}(Ae),wt=(n(541),function(e){(0,Ie.Z)(n,e);var t=(0,He.Z)(n);function n(e,a,o){var i;return(0,Ce.Z)(this,n),i=t.call(this,e.speciesName,a),i.datatrackSets=[],i.geneLabels=[],i.backbone=e,null!==o&&void 0!==o&&o.datatracks&&i.datatrackSets.push(new _e(o.datatracks,"gene")),o&&o.datatracks.length>0&&i.backbone.setBackboneGenes(o.genes),i.setBackboneXPositions(),i.createTitleLabels(),i.setDatatrackXPositions(),"detailed"===i.backbone.renderType&&(Me.Z.time("Create Backbone Gene Labels"),i.generateGeneLabels(),Me.Z.timeEnd("Create Backbone Gene Labels")),i}return(0,Ge.Z)(n,[{key:"createTitleLabels",value:function(){var e,t,n=new Xe({posX:this.backbone.posX1,posY:x.ZP.trackLabelYPosition,text:null!==(e=this.speciesName)&&void 0!==e?e:"Unknown"}),a=new Xe({posX:this.backbone.posX1,posY:x.ZP.trackMapLabelYPosition,text:null!==(t=this.mapName)&&void 0!==t?t:"Unknown",addClass:"smaller"});this.titleLabels=[n,a]}},{key:"setBackboneXPositions",value:function(){"overview"===this.backbone.renderType?(this.backbone.posX1=x.ZP.backboneXPosition,this.backbone.posX2=this.backbone.posX1+x.ZP.trackWidth):"detailed"===this.backbone.renderType&&(this.backbone.posX1=x.ZP.selectedBackboneXPosition,this.backbone.posX2=this.backbone.posX1+x.ZP.trackWidth),this.backbone.width=Math.abs(this.backbone.posX2-this.backbone.posX1)}},{key:"setDatatrackXPositions",value:function(){var e=this;this.datatrackSets.forEach((function(t,n){t.datatracks.forEach((function(t){t.posX1=(0,ve.pE)(e.backbone.posX2,n),t.posX2=t.posX1+x.ZP.dataTrackWidth,t.width=x.ZP.dataTrackWidth,t.label&&(t.label.posX=t.posX2)}))}))}},{key:"generateGeneLabels",value:function(){var e=this;if(null!=this.backbone.backboneGenes&&0!==this.backbone.backboneGenes.length){for(var t=null,n=0;n<this.datatrackSets.length;n++)if("gene"===this.datatrackSets[n].type){t=(0,ve.pE)(this.backbone.posX2,n)+x.ZP.dataTrackWidth;break}if(null!=t){var a=this.backbone.backboneGenes.filter((function(t){return(0,ve.Oo)(t,e.backbone.windowSVGStart,e.backbone.windowStop)}));Me.Z.time("Create intermediate labels");for(var o=[],i=0;i<a.length;i++){var s=a[i],r=(0,ve.f_)(s.backboneStart,s.backboneStop,this.backbone.windowStart,this.backbone.windowStop);o.push({gene:s,posY:r,posX:t})}Me.Z.timeEnd("Create intermediate labels"),this.geneLabels=Oe(o)}else Me.Z.debug("(BackboneSet) generateGeneLabels: xPos is null after iterating through DatatrackSets")}}},{key:"addNewDatatrackSetToEnd",value:function(e,t){this.datatrackSets.push(new _e(e,t)),this.setDatatrackXPositions()}},{key:"addNewDatatrackSetToStart",value:function(e,t){this.datatrackSets.unshift(new _e(e,t)),this.setDatatrackXPositions(),this.updateGeneLabelXPositions()}},{key:"addToDatatrackSet",value:function(e,t){this.datatrackSets[t].addDatatrackSections(e),this.setDatatrackXPositions()}},{key:"removeDatatrackSet",value:function(e){this.datatrackSets.splice(e,1),this.setDatatrackXPositions(),this.updateGeneLabelXPositions()}},{key:"updateGeneLabelXPositions",value:function(){if(null!=this.backbone.backboneGenes&&0!==this.backbone.backboneGenes.length){for(var e=null,t=0;t<this.datatrackSets.length;t++)if("gene"===this.datatrackSets[t].type){e=(0,ve.pE)(this.backbone.posX2,t)+x.ZP.dataTrackWidth;break}if(null!=e)for(var n=0;n<this.geneLabels.length;n++)this.geneLabels[n].posX=e;else Me.Z.debug("(BackboneSet) updateGeneLabelXPositions: xPos is null after iterating through DatatrackSets")}}},{key:"geneDatatrackSetIndex",get:function(){for(var e=0;e<this.datatrackSets.length;e++)if("gene"===this.datatrackSets[e].type)return e;return 0}}]),n}(Te));function Pt(e,t,n,a,o){return new yt({chromosome:t.chromosome,species:e,start:n,stop:a,windowBasePairRange:{start:n,stop:a},renderType:o,createLabels:!0})}function Zt(e,t,n){for(var a={datatracks:[],genes:t},o=new $e(e.name,e.activeMap.name,n.chromosome,n.windowBasePairRange,n.renderType),i=n.windowBasePairRange.stop-n.windowBasePairRange.start,s=0,r=0,l=t.length;r<l;r++){var c=t[r];if(Math.abs(c.stop-c.start)<(0,ve.zQ)(i))s++;else{var u=o.createGeneDatatrackSection({gene:c,start:c.start,stop:c.stop,backboneAlignment:{start:c.start,stop:c.stop}});a.datatracks.push(u)}}return Me.Z.debug("Filtered out gene count for backbone: ".concat(s)),{backboneSection:n,processedGenomicData:a}}function Bt(e,t,n){return new wt(e,t,n)}var Dt=function(){function e(t,n,a,o){(0,Ce.Z)(this,e),this.svgYPoint=t,this.svgHeight=n,this.basePairStart=a,this.basePairStop=o}return(0,Ge.Z)(e,[{key:"length",get:function(){return this.basePairStop-this.basePairStart}}]),e}(),Lt=function(){function e(t,n){(0,Ce.Z)(this,e),this.chromosome=t,this.viewportSelection=n}return(0,Ge.Z)(e,[{key:"setViewportSelection",value:function(e,t){e=e<0?0:Math.floor(e),t=t>this.chromosome.seqLength?this.chromosome.seqLength:Math.ceil(t);var n=x.lv-x.ef-2*x.ZP.overviewTrackPadding,a=this.chromosome.seqLength,o=n/a,i=e*o+x.ZP.overviewTrackYPosition,s=(t-e)*o;return this.viewportSelection=new Dt(i,s,e,t),this.viewportSelection}}]),e}(),xt=["fill","x","y","width","height"],Ut=["x","y"],Ct=["x","y"],Gt=["onMouseenter","onMouseleave","onClick","y","x","width","height","fill","fill-opacity","stroke"],_t=["x","y","width","height"],Mt=["x","y"],Yt=["x","y"],It=["x","y"],Ht=["x1","x2","y1","y2"];const Tt=(0,o.aZ)({__name:"BackboneSetSVG",props:{showDataOnHover:{type:Boolean},backboneSet:null,syntenyHoverSvgY:null,geneList:null},emits:["synteny-hover"],setup:function(e,t){var n=t.emit,a=e,i=4,s="#FF7C60",r="#FF4822",l=(0,S.oR)(w.J),c=W(),u=c.getBasePairPositionFromMouseEvent,p=c.getBasePairPositionFromSVG,v=c.mouseYPos,h=F(l),b=h.setHoverOnGeneLinesAndDatatrackSections,m=h.onDatatrackSectionClick,k=(0,g.Fl)((function(){return a.backboneSet.backbone})),Z=(0,g.Fl)((function(){return a.backboneSet.datatrackSets})),B=(0,g.Fl)((function(){return"detailed"===a.backboneSet.backbone.renderType})),D=(0,g.Fl)((function(){return null!=a.syntenyHoverSvgY&&null!=v.value&&B.value}));(0,g.BK)(a);var L,U=(0,g.iH)();l.state.chromosome&&(U.value=null!==(L=l.state.selectedBackboneRegion)&&void 0!==L?L:new Lt(l.state.chromosome));var C=(0,g.iH)("");(0,o.YP)((function(){return l.state.selectedBackboneRegion}),(function(e){B.value||null!=e||null==l.state.chromosome?B.value||null==e||(U.value=e):U.value=new Lt(l.state.chromosome)}),{deep:!0}),(0,o.YP)([function(){return l.state.selectedGeneIds},function(){return a.backboneSet}],(function(){I(l.state.selectedGeneIds)})),(0,o.YP)((function(){return a.syntenyHoverSvgY}),(function(){a.backboneSet.backbone.isHovered||null==a.syntenyHoverSvgY||T(a.syntenyHoverSvgY)})),(0,o.bv)((function(){I(l.state.selectedGeneIds)}));var G=function(e,t){if(e&&(e.isHovered=!0),"qtl"!==e.type)if(0===l.state.selectedGeneIds.length&&"gene"===e.type){var n=[],a=e;if(b(null===a||void 0===a?void 0:a.lines,!0),a.lines.length>0){var o=(0,A.XK)(a.lines[0]),i=o.selectedData;n.push.apply(n,(0,d.Z)(i))}else n.push(new y.Z(a.gene.clone(),"Gene"));l.dispatch("setSelectedData",n)}else if(0===l.state.selectedGeneIds.length)if("variant"===e.type){var s=new y.Z(e,"variantDensity");l.dispatch("setSelectedData",[s])}else{var r=new y.Z(e,t);l.dispatch("setSelectedData",[r])}},_=function(e){if(n("synteny-hover",null),e&&1==e.isHovered&&(e.isHovered=!1),"qtl"!==e.type&&"variant"!==e.type){if("gene"===e.type){var t=e;b(null===t||void 0===t?void 0:t.lines,!1)}0===l.state.selectedGeneIds.length&&l.dispatch("setSelectedData",null)}},M=function(e){return e.isSelected?r:e.isHovered?s:e.elementColor},Y=function(e){return"variant"===e.type?"section clickable variant":"section clickable"},I=function(e){var t;null===(t=Z.value[a.backboneSet.geneDatatrackSetIndex])||void 0===t||t.datatracks.forEach((function(t){null!=t.gene&&(e.includes(t.gene.rgdId)?t.isSelected=!0:t.isSelected=!1)}))},H=function(e){var t,o=u(e,k.value.windowSVGStart,k.value.windowSVGStop,k.value.windowStart,k.value.windowStop);(C.value=P.M.convertBasePairToLabel(o)||"",a.backboneSet.backbone.isHovered)&&n("synteny-hover",null!==(t=v.value)&&void 0!==t?t:null)},T=function(e){var t=p(e,k.value.windowSVGStart,k.value.windowSVGStop,k.value.windowStart,k.value.windowStop);C.value=P.M.convertBasePairToLabel(t)||""};return function(t,n){var a;return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,g.SU)(k)?((0,o.wg)(),(0,o.iD)("rect",{key:0,"data-test":"track-section-svg",class:"section",onMouseenter:n[0]||(n[0]=function(){return G((0,g.SU)(k),"backbone")}),onMouseleave:n[1]||(n[1]=function(){return _((0,g.SU)(k))}),onMousemove:n[2]||(n[2]=function(e){return H(e)}),fill:(0,g.SU)(k).isHovered&&e.showDataOnHover?s:(0,g.SU)(k).elementColor,x:(0,g.SU)(k).posX1,y:(0,g.SU)(k).posY1,width:(0,g.SU)(k).width,height:(0,g.SU)(k).height},null,40,xt)):(0,o.kq)("",!0),(0,g.SU)(k)?((0,o.wg)(),(0,o.iD)("text",{key:1,class:"chromosome-label",x:(0,g.SU)(k).posX1+(0,g.SU)(x.ZP).trackWidth/2,y:(0,g.SU)(k).windowSVGMiddle,"dominant-baseline":"middle","text-anchor":"middle"},(0,f.zw)((0,g.SU)(k).chromosome),9,Ut)):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,g.SU)(k).labels,(function(e,t){return(0,o.wg)(),(0,o.iD)(o.HY,{key:t},[e.isVisible?((0,o.wg)(),(0,o.iD)("text",{key:0,"data-test":"bp-label",class:"label small",x:e.posX,y:e.posY},(0,f.zw)(e.text),9,Ct)):(0,o.kq)("",!0)],64)})),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,g.SU)(Z),(function(t,n){return(0,o.wg)(),(0,o.iD)(o.HY,{key:n},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.datatracks,(function(n,a){return(0,o.wg)(),(0,o.iD)("rect",{key:a,class:(0,f.C_)(Y(t)),onMouseenter:function(){return G(n,"Gene")},onMouseleave:function(){return _(n)},onClick:function(t){return(0,g.SU)(m)(t,n,e.geneList)},y:n.posY1,x:n.posX1,width:n.width,height:n.height,fill:M(n),"fill-opacity":n.opacity,stroke:M(n)},null,42,Gt)})),128))],64)})),128)),!(0,g.SU)(B)&&null!=(null===(a=(0,g.SU)(U))||void 0===a?void 0:a.viewportSelection)&&(0,g.SU)(U).viewportSelection.svgHeight>0?((0,o.wg)(),(0,o.iD)(o.HY,{key:2},[(0,o._)("rect",{stroke:"green",fill:"green","fill-opacity":"0.5",x:(0,g.SU)(k).posX1-2,y:(0,g.SU)(U).viewportSelection.svgYPoint,width:(0,g.SU)(x.ZP).trackWidth+i,height:(0,g.SU)(U).viewportSelection.svgHeight},null,8,_t),(0,g.SU)(U).viewportSelection.svgYPoint>(0,g.SU)(k).posY1+10?((0,o.wg)(),(0,o.iD)("text",{key:0,class:"label small",x:(0,g.SU)(k).posX1-5,y:(0,g.SU)(U).viewportSelection.svgYPoint-2},(0,f.zw)((0,g.SU)(P.M).convertBasePairToLabel((0,g.SU)(U).viewportSelection.basePairStart)),9,Mt)):(0,o.kq)("",!0),(0,g.SU)(U).viewportSelection.svgYPoint+(0,g.SU)(U).viewportSelection.svgHeight<(0,g.SU)(k).posY2-10?((0,o.wg)(),(0,o.iD)("text",{key:1,class:"label small",x:(0,g.SU)(k).posX1-5,y:(0,g.SU)(U).viewportSelection.svgYPoint+(0,g.SU)(U).viewportSelection.svgHeight+7},(0,f.zw)((0,g.SU)(P.M).convertBasePairToLabel((0,g.SU)(U).viewportSelection.basePairStop)),9,Yt)):(0,o.kq)("",!0)],64)):(0,o.kq)("",!0),(0,g.SU)(D)?((0,o.wg)(),(0,o.iD)(o.HY,{key:3},[(0,o._)("text",{class:"label small","text-anchor":"end","dominant-baseline":"middle",x:(0,g.SU)(k).posX1-1,y:(0,g.SU)(v)},(0,f.zw)(C.value),9,It),(0,o._)("line",{class:"position-label",x1:(0,g.SU)(k).posX1,x2:(0,g.SU)(k).posX1+(0,g.SU)(k).width,y1:(0,g.SU)(v),y2:(0,g.SU)(v)},null,8,Ht)],64)):(0,o.kq)("",!0)],64)}}}),Xt=(0,s.Z)(Tt,[["__scopeId","data-v-76051490"]]),Rt=Xt;var qt=["stroke","x1","x2","y1","y2"];const Et=(0,o.aZ)({__name:"OrthologLineSVG",props:{line:null},setup:function(e){var t=e,n=(0,S.oR)(w.J),a="#FF4822",i="#FF7C60",s=(0,o.Fl)((function(){var e=n.state.selectedGeneIds;return t.line.isSelected||e.includes(t.line.endGene.rgdId||t.line.startGene.rgdId||-1)?a:t.line.isHovered?i:"lightgray"})),r=function(e){if(e.isSelected||(p(e,!0),u(e,i)),0===n.state.selectedGeneIds.length){var t=(0,A.XK)(e),a=t.selectedData;n.dispatch("setSelectedData",a)}},l=function(e){e.isSelected||(p(e,!1),u(e,"#000000")),0===n.state.selectedGeneIds.length&&n.dispatch("setSelectedData",null)},c=function(e,t){var o=n.state.selectedGeneIds.includes(t.endGene.rgdId||t.startGene.rgdId||-1);if(t.isSelected||o)return n.dispatch("setSelectedGeneIds",[]),n.dispatch("setSelectedData",null),void(t.isSelected=!1);u(t,a);var i=e.shiftKey?(0,d.Z)(n.state.selectedGeneIds):[],s=[],r=(0,A.XK)(t),l=r.selectedData,c=r.selectedGeneIds;if(s.push.apply(s,(0,d.Z)(l)),i.push.apply(i,(0,d.Z)(c)),n.dispatch("setSelectedGeneIds",i||[]),e.shiftKey){var p=[].concat((0,d.Z)(n.state.selectedData||[]),s);n.dispatch("setSelectedData",p)}else n.dispatch("setSelectedData",s)},u=function(e,t){[e].concat((0,d.Z)(e.chainedOrthologLines)).forEach((function(e){e.startGeneDatatrack&&(e.startGeneDatatrack.elementColor=t),e.endGeneDatatrack&&(e.endGeneDatatrack.elementColor=t)}))},p=function(e,t){[e].concat((0,d.Z)(e.chainedOrthologLines)).forEach((function(e){e.isHovered=t}))};return function(t,n){return(0,o.wg)(),(0,o.iD)("line",{class:"ortholog-line",stroke:(0,g.SU)(s),x1:e.line.posX1,x2:e.line.posX2,y1:e.line.posY1,y2:e.line.posY2,onClick:n[0]||(n[0]=function(t){return c(t,e.line)}),onMouseenter:n[1]||(n[1]=function(t){return r(e.line)}),onMouseleave:n[2]||(n[2]=function(t){return l(e.line)})},null,40,qt)}}}),Ot=(0,s.Z)(Et,[["__scopeId","data-v-5aa3b7d2"]]),Vt=Ot;var zt={class:"loading-mask"},Nt=(0,o.uE)('<div class="loader" data-v-3ca244f9><div class="dot dot1" data-v-3ca244f9><i data-v-3ca244f9></i></div><div class="dot dot2" data-v-3ca244f9><i data-v-3ca244f9></i></div><div class="dot dot3" data-v-3ca244f9><i data-v-3ca244f9></i></div><div class="dot dot4" data-v-3ca244f9><i data-v-3ca244f9></i></div><div class="dot dot5" data-v-3ca244f9><i data-v-3ca244f9></i></div><div class="dot dot6" data-v-3ca244f9><i data-v-3ca244f9></i></div><div class="dot dot7" data-v-3ca244f9><i data-v-3ca244f9></i></div><div class="dot dot8" data-v-3ca244f9><i data-v-3ca244f9></i></div><div class="dot dot9" data-v-3ca244f9><i data-v-3ca244f9></i></div></div>',1),Wt=[Nt];function At(e,t){return(0,o.wg)(),(0,o.iD)("div",zt,Wt)}const Kt={},Ft=(0,s.Z)(Kt,[["render",At],["__scopeId","data-v-3ca244f9"]]),jt=Ft;var Jt=function(e){return(0,o.dD)("data-v-97b6c138"),e=e(),(0,o.Cn)(),e},Qt={class:"legend-label"},$t={class:"legend-container"},en=Jt((function(){return(0,o._)("div",{class:"color-legend"},null,-1)}));const tn=(0,o.aZ)({__name:"GradientLegend",props:{minValue:null,maxValue:null,binSize:null,minColor:null,maxColor:null,speciesName:null,mapName:null},setup:function(e){return(0,a.sj)((function(t){return{"06e13e28":e.minColor,"666dfd1a":e.maxColor}})),function(t,n){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",Qt,(0,f.zw)(e.speciesName)+" ("+(0,f.zw)(e.mapName)+")",1),(0,o._)("div",$t,[(0,o._)("div",null,(0,f.zw)(parseFloat(e.minValue.toPrecision(3)).toLocaleString()),1),en,(0,o._)("div",null,(0,f.zw)(parseFloat(e.maxValue.toPrecision(3)).toLocaleString()),1)])])}}}),nn=(0,s.Z)(tn,[["__scopeId","data-v-97b6c138"]]),an=nn;var on=["viewBox"],sn=["height"],rn=["width","height"],ln=["x","width","height"],cn=["x","y","width","height"],un=["x","y","width","height"],dn=["x","y"],pn=["x","y"],vn=["width","height"],hn=["x","width","height"],gn=["x","y","width","height"],bn=["y","width","height"],fn={key:0,class:"grid"},mn={class:"col-4 plus-half legend-title"},kn={class:"col-2 legend-container"};const Sn=(0,o.aZ)({__name:"SVGViewbox",props:{geneList:null,syntenyTree:null,loading:{type:Boolean},variantPositionsList:null},setup:function(e){var t=e,n=.2,i=(0,S.oR)(w.J),s=(0,Le.wL)(),r=(0,u.tv)(),l=(0,St.p)(),c=xe(),d=c.showDialog,p=c.dialogHeader,y=c.dialogMessage,P=c.showDialogBackButton,Z=c.dialogTheme,B=c.onError,D=Ue(i),L=D.startDetailedSelectionY,U=D.stopDetailedSelectionY,C=D.updateZoomSelection,G=D.detailedSelectionHandler,_=D.cancelDetailedSelection,M=D.getDetailedSelectionStatus,Y=mt(i),I=Y.startOverviewSelectionY,H=Y.stopOverviewSelectionY,T=Y.updateOverviewSelection,X=Y.overviewSelectionHandler,R=Y.cancelOverviewSelection,q=Y.getOverviewSelectionStatus,E=(0,g.iH)([]),O=(0,g.iH)(),V=(0,g.iH)(),z=(0,g.iH)([]),N=(0,g.iH)(),W=(0,g.iH)(null);(0,g.iH)([]),(0,g.iH)([]);function K(e,t){return F.apply(this,arguments)}function F(){return F=(0,h.Z)((0,v.Z)().mark((function e(t,n){return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,i.dispatch(t,!0),e.next=4,n();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),B(e.t0,"An error occurred while updating the overview panel",!1);case 9:return e.prev=9,i.dispatch(t,!1),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])}))),F.apply(this,arguments)}(0,o.bv)((0,h.Z)((0,v.Z)().mark((function e(){return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),(0,o.YP)((function(){return i.state.configurationLoaded}),(function(){i.state.configurationLoaded&&K("setIsOverviewPanelUpdating",ee)})),(0,o.YP)((function(){return i.state.detailedBasePairRange}),(function(){i.state.configurationLoaded&&K("setIsDetailedPanelUpdating",te)})),(0,o.YP)((function(){return t.variantPositionsList}),(function(){var e,n=i.state.species,a=null===(e=V.value)||void 0===e?void 0:e.backbone;n&&a&&t.variantPositionsList.forEach((function(e){e.mapKey===n.activeMap.key&&de(n,e,a)}))}),{deep:!0}),(0,o.YP)((function(){return i.state.isUpdatingVariants}),(function(){i.state.isUpdatingVariants&&ve()}));var j=(0,o.Fl)((function(){return i.state.isOverviewPanelUpdating||i.state.isDetailedPanelUpdating||t.loading})),J=(0,o.Fl)((function(){var e,t=null===(e=V.value)||void 0===e?void 0:e.datatrackSets.findIndex((function(e){return"variant"===e.type}));if(void 0!==t&&-1!==t)return!0;for(var n=0;n<E.value.length;n++){var a=E.value[n].regions.some((function(e){return-1!==e.datatrackSets.findIndex((function(e){return"variant"===e.type}))}));if(a)return!0}return!1})),Q=(0,o.Fl)((function(){var e;if(null!==(e=V.value)&&void 0!==e&&e.variantBinSize)return V.value.variantBinSize;if(E.value.some((function(e){return e.variantBinSize}))){var t,n=E.value.find((function(e){return e.variantBinSize&&e.variantBinSize>0}));return null!==(t=null===n||void 0===n?void 0:n.variantBinSize)&&void 0!==t?t:0}return 0})),$=function(){return q()||M()},ee=function(){var e=(0,h.Z)((0,v.Z)().mark((function e(){var n,a,o,r,l,c,u;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s.debug("Updating Overview Panel"),n=Date.now(),a=i.state.species,o=i.state.chromosome,null!=a&&null!=o){e.next=8;break}return s.error("Backbone species or chromosome is null during overview panel update"),z.value=[],e.abrupt("return");case 8:return z.value=[],r=Pt(a,o,0,o.seqLength,"overview"),O.value=Bt(r,a.activeMap),l=Date.now(),c=Date.now(),e.next=15,pt(t.syntenyTree,i.state.comparativeSpecies,o);case 15:z.value=e.sent,u=Date.now(),ge("Update Overview Time",u-n,{"Create Backbone Track":l-n,"Create Synteny Tracks":c-l,"Create Backbone Selection":u-c});case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=(0,h.Z)((0,v.Z)().mark((function e(){var n,a,o,r,l,c,u,d,p,h,g,b,f,m,k,S,y,w,P;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s.debug("Updating Detailed Panel"),n=Date.now(),a=i.state.species,o=i.state.chromosome,r=i.state.detailedBasePairRange,l=[],i.state.comparativeSpecies.map((function(e){return l.push(e.defaultMapKey)})),c=0,u=0,d=0,p=0,h=0,!(r.stop-r.start<=0)){e.next=16;break}return s.error("Invalid detailedBasePairRange?? (".concat(r.start,", ").concat(r.stop,")")),E.value=[],e.abrupt("return");case 16:if(null!=a&&null!=o){e.next=19;break}return E.value=[],e.abrupt("return");case 19:return g=Pt(a,o,i.state.detailedBasePairRange.start,i.state.detailedBasePairRange.stop,"detailed"),b=Date.now(),f=[],t.geneList.forEach((function(e){e.mapKey==a.activeMap.key&&ue(e.start,e.stop)&&f.push(e)})),u=Date.now()-b,m=Date.now(),k=Zt(a,f,g),d=Date.now()-m,S=Date.now(),V.value=Bt(g,a.activeMap,k.processedGenomicData),t.variantPositionsList.forEach((function(e){e.mapKey===a.activeMap.key&&de(a,e,g)})),p=Date.now()-S,y=Date.now(),e.next=34,ht(t.syntenyTree,i.state.comparativeSpecies,r.start,r.stop);case 34:E.value=e.sent,c=Date.now()-y,N.value=(0,A.oE)(t.geneList,V.value,E.value),w=Date.now()-n,P=w-(+u+d+p+c+h),ge("Update Detailed Time",w,{"Filter Backbone Genes":u,"Create Backbone Datatracks":d,"Create Backbone Set, and AdjustY":p,"Create Synteny Tracks":c,"Adjust Visible Region":h,Misc:P});case 40:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=i.state.selectedBackboneRegion;if(!oe.value&&null!=(null===e||void 0===e?void 0:e.viewportSelection)&&i.state.detailedBasePairRange){var t=i.state.detailedBasePairRange,a=n*(t.stop-t.start);t.start<a&&(a=t.start),i.dispatch("setDetailedBasePairRequest",{start:t.start-a,stop:t.stop-a})}},ae=function(){var e=i.state.selectedBackboneRegion;if(!ie.value&&null!=(null===e||void 0===e?void 0:e.viewportSelection)){var t=e.chromosome;if(i.state.detailedBasePairRange){var a=i.state.detailedBasePairRange,o=n*(a.stop-a.start);a.stop+o>t.seqLength&&(o=t.seqLength-a.stop),i.dispatch("setDetailedBasePairRequest",{start:a.start+o,stop:a.stop+o})}}},oe=(0,o.Fl)((function(){if(j.value)return!0;var e=i.state.selectedBackboneRegion;return!(!e||!e.viewportSelection)&&0>e.viewportSelection.basePairStart})),ie=(0,o.Fl)((function(){if(j.value)return!0;var e=i.state.selectedBackboneRegion;return!(!e||!e.viewportSelection)&&0>=e.viewportSelection.basePairStop})),se=function(e){W.value=e},ce=function(){var e=document.getElementById("detailed"),t=window.scrollY,n=window.scrollX;if(e){var a=e.getBoundingClientRect();return{position:"absolute",top:String(a.top+t)+"px",bottom:String(a.bottom)+"px",right:String(a.right)+"px",left:String(a.left+n)+"px",width:String(a.width)+"px",height:String(a.height)+"px"}}},ue=function(e,t){var n,a,o,s,r=i.state.selectedBackboneRegion,l=null!==(n=null===r||void 0===r||null===(a=r.viewportSelection)||void 0===a?void 0:a.basePairStart)&&void 0!==n?n:-1,c=null!==(o=null===r||void 0===r||null===(s=r.viewportSelection)||void 0===s?void 0:s.basePairStop)&&void 0!==o?o:-1;return e<=c&&t>=l},de=function(e,t,n){var a=lt(e,t,n);if(V.value){var o,i;null===(o=V.value)||void 0===o||o.addNewDatatrackSetToStart(a.datatracks,"variant"),V.value.maxVariantCount=a.maxCount,V.value.variantBinSize=a.binSize;var s=V.value.backbone.posX2+2*x.ZP.backboneDatatrackXOffset+2*x.ZP.dataTrackWidth;null===(i=N.value)||void 0===i||i.forEach((function(e){var t;e.startGene.mapKey===(null===(t=V.value)||void 0===t?void 0:t.mapKey)&&(e.posX1=s)}))}},ve=function(){te(),i.dispatch("setIsUpdatingVariants",!1)};document.addEventListener("scroll",ce),r.beforeEach((function(e,t,n){if(window&&window.event&&"popstate"==window.event.type){var a=confirm("Are you sure you want to leave this page? You may lose progress.");1==a?n():n(!1)}else n()})),window.addEventListener("keyup",(function(e){27===e.keyCode&&(R(),_())}));var he=function(e,t,n,a){var o=i.state.selectionToastCount;o%10==0&&l.add({severity:e,summary:t,detail:n,life:a})};function ge(e,t,n){var a,o=(a={},(0,b.Z)(a,e,t+" ms"),(0,b.Z)(a,"Details",{}),a);for(var i in n)o.Details[i]=n[i]+" ms | "+(n[i]/t*100).toFixed(2)+"%";s.debug(JSON.stringify(o,null,2))}return function(t,n){var i,s,r;return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)((0,g.SU)(kt.Z)),((0,o.wg)(),(0,o.iD)("svg",{viewBox:"0 0 800 "+(0,g.SU)(x.ZP).viewboxHeight,xmlns:"http://www.w3.org/2000/svg",id:"svg-wrapper",width:"100%"},[(0,o._)("rect",{class:"panel",x:"0",width:"800",height:(0,g.SU)(x.ZP).viewboxHeight},null,8,sn),(0,o._)("rect",{class:(0,f.C_)(["panel selectable",{"is-loading":(0,g.SU)(j)}]),x:"0",onClick:n[0]||(n[0]=(0,a.iM)((function(e){var t;(0,g.SU)(X)(e,(0,g.SU)(M)(),null===(t=(0,g.SU)(O))||void 0===t?void 0:t.backbone),he("info","Selection Initiated:","Drag and click again to complete the selection or right click to cancel.",5e3)}),["left"])),onMousemove:n[1]||(n[1]=(0,a.iM)((function(e){return(0,g.SU)(T)(e)}),["stop"])),onContextmenu:[n[2]||(n[2]=(0,a.iM)((function(){}),["prevent"])),n[3]||(n[3]=(0,a.iM)((function(){return(0,g.SU)(R)&&(0,g.SU)(R).apply(void 0,arguments)}),["right"]))],width:(0,g.SU)(x.ZP).overviewPanelWidth,height:(0,g.SU)(x.ZP).viewboxHeight},null,42,rn),(0,o._)("rect",{id:"detailed",class:(0,f.C_)(["panel selectable",{"is-loading":(0,g.SU)(j)}]),onClick:n[4]||(n[4]=(0,a.iM)((function(e){(0,g.SU)(G)(e,(0,g.SU)(q)()),he("info","Selection Initiated:","Drag and click again to complete the selection or right click to cancel.",5e3)}),["left"])),onMousemove:n[5]||(n[5]=function(){return(0,g.SU)(C)&&(0,g.SU)(C).apply(void 0,arguments)}),onContextmenu:[n[6]||(n[6]=(0,a.iM)((function(){}),["prevent"])),n[7]||(n[7]=(0,a.iM)((function(){return(0,g.SU)(_)&&(0,g.SU)(_).apply(void 0,arguments)}),["right"]))],x:(0,g.SU)(x.ZP).overviewPanelWidth,width:(0,g.SU)(x.ZP).detailsPanelWidth,height:(0,g.SU)(x.ZP).viewboxHeight},null,42,ln),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,g.SU)(N),(function(e,t){return(0,o.wg)(),(0,o.j4)(Vt,{key:t,line:e},null,8,["line"])})),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,g.SU)(z),(function(t,n){return(0,o.wg)(),(0,o.iD)(o.HY,{key:n},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.regions,(function(t,n){return(0,o.wg)(),(0,o.j4)(re,{key:n,"show-chromosome":"","show-synteny-on-hover":"","gene-list":e.geneList,"show-start-stop":"","select-on-click":"",region:t},null,8,["gene-list","region"])})),128))],64)})),128)),(0,g.SU)(O)?((0,o.wg)(),(0,o.j4)(Rt,{key:0,"show-data-on-hover":"","gene-list":e.geneList,"backbone-set":(0,g.SU)(O)},null,8,["gene-list","backbone-set"])):(0,o.kq)("",!0),(0,g.SU)(V)?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Wm)(Rt,{"show-data-on-hover":"","backbone-set":(0,g.SU)(V),"synteny-hover-svg-y":(0,g.SU)(W),onSyntenyHover:se,"gene-list":e.geneList},null,8,["backbone-set","synteny-hover-svg-y","gene-list"]),(0,g.SU)(V).geneLabels?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:0},(0,o.Ko)((0,g.SU)(V).geneLabels,(function(t,n){var a;return(0,o.wg)(),(0,o.iD)(o.HY,{key:n},[t.isVisible?((0,o.wg)(),(0,o.j4)(pe,{key:0,label:t,"gene-list":e.geneList,"ortholog-lines":null!==(a=(0,g.SU)(N))&&void 0!==a?a:[]},null,8,["label","gene-list","ortholog-lines"])):(0,o.kq)("",!0)],64)})),128)):(0,o.kq)("",!0)],64)):(0,o.kq)("",!0),(0,g.SU)(E).length?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:2},(0,o.Ko)((0,g.SU)(E),(function(t,n){return(0,o.wg)(),(0,o.iD)(o.HY,{key:n},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.regions,(function(t,n){return(0,o.wg)(),(0,o.j4)(re,{key:n,"show-chromosome":"",region:t,"synteny-hover-svg-y":(0,g.SU)(W),"gene-list":e.geneList,onSyntenyHover:se},null,8,["region","synteny-hover-svg-y","gene-list"])})),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.geneLabels,(function(t,n){var a;return(0,o.wg)(),(0,o.iD)(o.HY,{key:n},[t.isVisible?((0,o.wg)(),(0,o.j4)(pe,{key:0,label:t,"gene-list":e.geneList,"ortholog-lines":null!==(a=(0,g.SU)(N))&&void 0!==a?a:[]},null,8,["label","gene-list","ortholog-lines"])):(0,o.kq)("",!0)],64)})),128))],64)})),128)):(0,o.kq)("",!0),(0,o.Wm)(De,{"overview-backbone-set":(0,g.SU)(O),"overview-synteny-sets":(0,g.SU)(z),"detailed-backbone-set":(0,g.SU)(V),"detailed-synteny-sets":(0,g.SU)(E)},null,8,["overview-backbone-set","overview-synteny-sets","detailed-backbone-set","detailed-synteny-sets"]),(0,o._)("rect",{class:(0,f.C_)(["navigation-btn",{disabled:(0,g.SU)(oe)}]),onClick:ne,x:(0,g.SU)(x.ZP).overviewPanelWidth,y:(0,g.SU)(x.ZP).panelTitleHeight-(0,g.SU)(x.ZP).navigationButtonHeight,width:(0,g.SU)(x.ZP).detailsPanelWidth,height:(0,g.SU)(x.ZP).navigationButtonHeight},null,10,cn),(0,o._)("rect",{class:(0,f.C_)(["navigation-btn",{disabled:(0,g.SU)(ie)}]),onClick:ae,x:(0,g.SU)(x.ZP).overviewPanelWidth,y:(0,g.SU)(x.ZP).viewboxHeight-(0,g.SU)(x.ZP).navigationButtonHeight,width:(0,g.SU)(x.ZP).detailsPanelWidth,height:(0,g.SU)(x.ZP).navigationButtonHeight},null,10,un),(0,o._)("image",{class:"nav-btn-img",href:m,onClick:ne,x:(0,g.SU)(x.ZP).overviewPanelWidth+(0,g.SU)(x.ZP).detailsPanelWidth/2,y:(0,g.SU)(x.ZP).panelTitleHeight-(0,g.SU)(x.ZP).navigationButtonHeight-1,width:"20",height:"20"},null,8,dn),(0,o._)("image",{class:"nav-btn-img",href:k,onClick:ae,x:(0,g.SU)(x.ZP).overviewPanelWidth+(0,g.SU)(x.ZP).detailsPanelWidth/2,y:(0,g.SU)(x.ZP).viewboxHeight-(0,g.SU)(x.ZP).navigationButtonHeight-1,width:"20",height:"20"},null,8,pn),$()?((0,o.wg)(),(0,o.iD)("rect",{key:3,id:"selecting-overview",class:(0,f.C_)(["selecting-panel",{"is-loading":(0,g.SU)(j)}]),x:"0",onMousemove:n[8]||(n[8]=function(){return(0,g.SU)(T)&&(0,g.SU)(T).apply(void 0,arguments)}),onContextmenu:[n[9]||(n[9]=(0,a.iM)((function(){}),["prevent"])),n[10]||(n[10]=(0,a.iM)((function(){return(0,g.SU)(R)&&(0,g.SU)(R).apply(void 0,arguments)}),["right"]))],onClick:n[11]||(n[11]=(0,a.iM)((function(e){var t;return(0,g.SU)(X)(e,(0,g.SU)(M)(),null===(t=(0,g.SU)(O))||void 0===t?void 0:t.backbone)}),["left"])),width:(0,g.SU)(x.ZP).overviewPanelWidth,height:(0,g.SU)(x.ZP).viewboxHeight},null,42,vn)):(0,o.kq)("",!0),$()?((0,o.wg)(),(0,o.iD)("rect",{key:4,id:"selecting-detailed",class:(0,f.C_)(["selecting-panel",{"is-loading":(0,g.SU)(j)}]),onMousemove:n[12]||(n[12]=function(){return(0,g.SU)(C)&&(0,g.SU)(C).apply(void 0,arguments)}),onContextmenu:[n[13]||(n[13]=(0,a.iM)((function(){}),["prevent"])),n[14]||(n[14]=(0,a.iM)((function(){return(0,g.SU)(_)&&(0,g.SU)(_).apply(void 0,arguments)}),["right"]))],onClick:n[15]||(n[15]=(0,a.iM)((function(e){return(0,g.SU)(G)(e,(0,g.SU)(q)())}),["left"])),x:(0,g.SU)(x.ZP).overviewPanelWidth,width:(0,g.SU)(x.ZP).detailsPanelWidth,height:(0,g.SU)(x.ZP).viewboxHeight},null,42,hn)):(0,o.kq)("",!0),(0,g.SU)(L)&&(0,g.SU)(U)?((0,o.wg)(),(0,o.iD)("rect",{key:5,class:"visible-selecting-panel",onMousedown:n[16]||(n[16]=(0,a.iM)((function(e){return(0,g.SU)(G)(e,(0,g.SU)(q)())}),["left"])),onContextmenu:[n[17]||(n[17]=(0,a.iM)((function(){return(0,g.SU)(_)&&(0,g.SU)(_).apply(void 0,arguments)}),["right"])),n[19]||(n[19]=(0,a.iM)((function(){}),["prevent"]))],onMousemove:n[18]||(n[18]=function(){return(0,g.SU)(C)&&(0,g.SU)(C).apply(void 0,arguments)}),fill:"lightgray","fill-opacity":"0.4",x:(0,g.SU)(x.ZP).overviewPanelWidth,y:(0,g.SU)(L),width:(0,g.SU)(x.ZP).detailsPanelWidth,height:(0,g.SU)(U)-(0,g.SU)(L)},null,40,gn)):(0,o.kq)("",!0),(0,g.SU)(I)&&(0,g.SU)(H)?((0,o.wg)(),(0,o.iD)("rect",{key:6,class:"visible-selecting-panel",onMousemove:n[20]||(n[20]=function(e){return(0,g.SU)(T)(e)}),onContextmenu:[n[21]||(n[21]=(0,a.iM)((function(){}),["prevent"])),n[23]||(n[23]=(0,a.iM)((function(){return(0,g.SU)(R)&&(0,g.SU)(R).apply(void 0,arguments)}),["right"]))],onMousedown:n[22]||(n[22]=(0,a.iM)((function(e){var t;return(0,g.SU)(X)(e,(0,g.SU)(M)(),null===(t=(0,g.SU)(O))||void 0===t?void 0:t.backbone)}),["left"])),fill:"lightgray","fill-opacity":"0.4",x:0,y:(0,g.SU)(I),width:(0,g.SU)(x.ZP).overviewPanelWidth,height:(0,g.SU)(H)-(0,g.SU)(I)},null,40,bn)):(0,o.kq)("",!0)],8,on)),(0,g.SU)(J)?((0,o.wg)(),(0,o.iD)("div",fn,[(0,o._)("div",mn,[(0,o._)("b",null,"Variant counts (per "+(0,f.zw)(parseFloat((0,g.SU)(Q).toPrecision(3)).toLocaleString())+"bp)",1)]),(0,o._)("div",kn,[(0,g.SU)(V)&&(0,g.SU)(V).maxVariantCount&&(0,g.SU)(V).variantBinSize&&(0,g.SU)(V).maxVariantCount>0?((0,o.wg)(),(0,o.j4)(an,{key:0,"species-name":(null===(i=(0,g.SU)(V))||void 0===i?void 0:i.speciesName)||"","map-name":null===(s=(0,g.SU)(V))||void 0===s?void 0:s.mapName,"min-value":0,"max-value":(null===(r=(0,g.SU)(V))||void 0===r?void 0:r.maxVariantCount)||0,"bin-size":(0,g.SU)(V).variantBinSize,"min-color":"#0000FF","max-color":"#FF0000"},null,8,["species-name","map-name","max-value","bin-size"])):(0,o.kq)("",!0)]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,g.SU)(E),(function(e,t){return(0,o.wg)(),(0,o.iD)("div",{key:t,class:"col-2 legend-container"},[e.variantBinSize&&e.maxVariantCount&&e.maxVariantCount>0?((0,o.wg)(),(0,o.j4)(an,{key:0,"species-name":e.speciesName,"map-name":e.mapName,"min-value":0,"max-value":e.maxVariantCount,"bin-size":e.variantBinSize,"min-color":"#0000FF","max-color":"#FF0000"},null,8,["species-name","map-name","max-value","bin-size"])):(0,o.kq)("",!0)])})),128))])):(0,o.kq)("",!0),(0,o.Wm)(le.Z,{show:(0,g.SU)(d),"onUpdate:show":n[24]||(n[24]=function(e){return(0,g.dq)(d)?d.value=e:null}),header:(0,g.SU)(p),message:(0,g.SU)(y),theme:(0,g.SU)(Z),"show-back-button":(0,g.SU)(P)},null,8,["show","header","message","theme","show-back-button"]),(0,g.SU)(j)?((0,o.wg)(),(0,o.j4)(jt,{key:1,style:(0,f.j5)(ce())},null,8,["style"])):(0,o.kq)("",!0)],64)}}}),yn=(0,s.Z)(Sn,[["__scopeId","data-v-7507686c"]]),wn=yn;var Pn=n(2546),Zn=n(4186),Bn=function(e){return(0,o.dD)("data-v-7d10cb1d"),e=e(),(0,o.Cn)(),e},Dn={class:"grid unpadded col-4"},Ln={class:"col-12"},xn=Bn((function(){return(0,o._)("h4",null,"Overview",-1)})),Un={class:"grid unpadded"},Cn=Bn((function(){return(0,o._)("div",{class:"col-5"},"Backbone:",-1)})),Gn={class:"col-7 bold","data-test":"backbone-overview-display"},_n=Bn((function(){return(0,o._)("div",{class:"col-5"},"Length:",-1)})),Mn={class:"col-7 bold"},Yn={class:"p-fluid col-12 bold"},In={class:"grid p-d-flex"},Hn={class:"col-6"},Tn=Bn((function(){return(0,o._)("h4",{class:"config-label"},"Start Position",-1)})),Xn=Bn((function(){return(0,o._)("p",{class:"label-description"},"Min: 0bp",-1)})),Rn={class:"load-by-position-label"},qn={class:"col-6"},En=Bn((function(){return(0,o._)("h4",{class:"config-label"},"Stop Position",-1)})),On={class:"label-description"},Vn={class:"load-by-position-label"},zn={class:"grid p-d-flex"},Nn={class:"col-6 left-align-btn"},Wn={class:"col-6"};const An=(0,o.aZ)({__name:"OverviewControls",setup:function(e){var t,n,a=(0,S.oR)(w.J),i=(0,Le.wL)(),s=(0,g.iH)(!1),r=(0,g.iH)(0),l=(0,g.iH)(null!==(t=null===(n=a.state.chromosome)||void 0===n?void 0:n.seqLength)&&void 0!==t?t:1),c=(0,o.Fl)((function(){return r.value<l.value})),u=(0,o.Fl)((function(){var e,t;return null!==(e=null===(t=a.state.chromosome)||void 0===t?void 0:t.seqLength)&&void 0!==e?e:0})),d=(0,o.Fl)((function(){return null==a.state.chromosome?"-":P.M.addCommasToBasePair(a.state.chromosome.seqLength)})),p=function(){var e,t,n,o,i,c,u,d,p=0,v=null!==(e=null===(t=a.state.chromosome)||void 0===t?void 0:t.seqLength)&&void 0!==e?e:0;r.value=null!==(n=null===(o=a.state.selectedBackboneRegion)||void 0===o||null===(i=o.viewportSelection)||void 0===i?void 0:i.basePairStart)&&void 0!==n?n:p,l.value=null!==(c=null===(u=a.state.selectedBackboneRegion)||void 0===u||null===(d=u.viewportSelection)||void 0===d?void 0:d.basePairStop)&&void 0!==c?c:v,s.value=!0},v=function(){s.value=!1},h=function(){if(null!=a.state.chromosome){if(c.value){var e=a.state.selectedBackboneRegion;null===e||void 0===e||e.setViewportSelection(r.value,l.value),a.dispatch("setDetailedBasePairRequest",{start:r.value,stop:l.value})}s.value=!1}else i.error("Chromosome seq length required when adjusting backbone base selection")};return function(e,t){var n,i,b,m=(0,o.up)("Button"),k=(0,o.up)("InputNumber");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",Dn,[(0,o._)("div",Ln,[xn,(0,o._)("div",Un,[Cn,(0,o._)("div",Gn,(0,f.zw)(null===(n=(0,g.SU)(a).state.species)||void 0===n?void 0:n.name)+" chr"+(0,f.zw)(null===(i=(0,g.SU)(a).state.chromosome)||void 0===i?void 0:i.chromosome)+" ("+(0,f.zw)(null===(b=(0,g.SU)(a).state.species)||void 0===b?void 0:b.activeMap.name)+")",1),_n,(0,o._)("div",Mn,(0,f.zw)((0,g.SU)(d))+"bp",1),(0,o._)("div",Yn,[(0,o.Wm)(m,{label:"Edit BP Range",icon:"pi pi-pencil",class:"p-button-sm edit-bp-btn p-button-secondary",onClick:p})])])])]),(0,o.Wm)(le.Z,{show:(0,g.SU)(s),"onUpdate:show":t[2]||(t[2]=function(e){return(0,g.dq)(s)?s.value=e:s=e}),header:"Edit Selected Start/Stop Positions"},{content:(0,o.w5)((function(){return[(0,o._)("div",In,[(0,o._)("div",Hn,[Tn,Xn,(0,o.Wm)(k,{modelValue:(0,g.SU)(r),"onUpdate:modelValue":t[0]||(t[0]=function(e){return(0,g.dq)(r)?r.value=e:r=e}),max:(0,g.SU)(u)-1,min:0,useGrouping:!1},null,8,["modelValue","max"]),(0,o._)("div",Rn,(0,f.zw)((0,g.SU)(P.M).addCommasToBasePair((0,g.SU)(r)))+(0,f.zw)(null!==(0,g.SU)(P.M).evaluateBPInput((0,g.SU)(r))?"bp":"N/A"),1)]),(0,o._)("div",qn,[En,(0,o._)("p",On,"Max: "+(0,f.zw)((0,g.SU)(P.M).addCommasToBasePair((0,g.SU)(u)))+"bp",1),(0,o.Wm)(k,{modelValue:(0,g.SU)(l),"onUpdate:modelValue":t[1]||(t[1]=function(e){return(0,g.dq)(l)?l.value=e:l=e}),max:(0,g.SU)(u),min:1,useGrouping:!1},null,8,["modelValue","max"]),(0,o._)("div",Vn,(0,f.zw)((0,g.SU)(P.M).addCommasToBasePair((0,g.SU)(l)))+(0,f.zw)((0,g.SU)(l)?"bp":"N/A"),1)])])]})),footer:(0,o.w5)((function(){return[(0,o._)("div",zn,[(0,o._)("div",Nn,[(0,o.Wm)(m,{label:"Cancel",class:"p-button-outlined p-button-secondary",onClick:v})]),(0,o._)("div",Wn,[(0,o.Wm)(m,{label:"Confirm New Selection",class:"p-button-success",onClick:h,disabled:!(0,g.SU)(c)||(0,g.SU)(a).state.isOverviewPanelUpdating||(0,g.SU)(a).state.isDetailedPanelUpdating},null,8,["disabled"])])])]})),_:1},8,["show"])],64)}}}),Kn=(0,s.Z)(An,[["__scopeId","data-v-7d10cb1d"]]),Fn=Kn;var jn=function(e){return(0,o.dD)("data-v-7152d558"),e=e(),(0,o.Cn)(),e},Jn={class:"zoom-options-container"},Qn={class:"zoom-out-container"},$n={class:"interval-label"},ea=jn((function(){return(0,o._)("p",{class:"zoom-out-label"},"Zoom Out",-1)})),ta={class:"zoom-level-container"},na={class:"zoom-level-label"},aa={class:"zoom-in-container"},oa={class:"interval-label"},ia=jn((function(){return(0,o._)("p",{class:"zoom-in-label"},"Zoom In",-1)}));const sa=(0,o.aZ)({__name:"Zoom",setup:function(e){var t=(0,Le.wL)(),n=(0,S.oR)(w.J),a=(0,g.iH)(1),i=[1.5,3,10,100],s=(0,g.iH)(1);(0,o.YP)((function(){return n.state.detailedBasePairRange}),(function(e){var t,o,i=null!==(t=null===(o=n.state.chromosome)||void 0===o?void 0:o.seqLength)&&void 0!==t?t:0;a.value=1*i/(e.stop-e.start),s.value=h(a.value)}),{immediate:!0});var r=(0,o.Fl)((function(){return n.state.isDetailedPanelUpdating||null==n.state.chromosome})),l=function(e){n.state.isDetailedPanelUpdating||u(e.value)},c=function(e){var a=n.state.chromosome;if(t.debug("Zoom level: ".concat(e)),null!=a)if(1===e)n.dispatch("setDetailedBasePairRequest",{start:0,stop:a.seqLength});else{var o=n.state.detailedBasePairRange.start,i=n.state.detailedBasePairRange.stop,s=i-o,r=a.seqLength/s,l=s*(r/e),c=s-l;c>0?(o+=c/2,i-=c/2):c<0&&(o+=c/2,i-=c/2,o<0?(o=0,i=o-c>a.seqLength?a.seqLength:o+l):i>a.seqLength&&(i=a.seqLength,o=i+c<0?0:i-l)),n.dispatch("setDetailedBasePairRequest",{start:o,stop:i})}else t.error("Cannot zoom if selectedRegion, viewportSelection, or backboneChromosome is null")},u=function(e){s.value=e,t.debug("Zoom Step: ".concat(s.value));var a=n.state.selectedBackboneRegion;if(null==a||null==a.viewportSelection)t.error("ERROR WITH SELECTED REGION");else if(e<=1)c(1);else{var o=a.viewportSelection.basePairStop,i=v(1),r=v(o),l=i+(r-i)*e/99,u=Math.exp(l);t.debug("'Zoomed' after logZoom: ".concat(u)),c(u)}},d=function(e){c(a.value/e)},p=function(e){c(a.value*e)};function v(e){return Math.log(e)/Math.LN10}function h(e){var a=n.state.selectedBackboneRegion;if(null==a||null==a.viewportSelection)return t.error("Could not calculate zoom step from zoom level"),0;var o=a.viewportSelection.basePairStop,i=v(1),s=v(o),r=Math.log(e);return 99*(r-i)/(s-i)}return function(e,t){var n=(0,o.up)("Slider"),c=(0,o.up)("Button");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(n,{disabled:(0,g.SU)(r),class:"zoom-slider","data-test":"zoom-slider",modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=function(e){return s.value=e}),step:.5,min:1,max:100,onSlideend:l},null,8,["disabled","modelValue","step"]),(0,o._)("div",Jn,[(0,o._)("div",Qn,[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)(i,(function(e){return(0,o._)("div",{class:"zoom-options",key:e},[(0,o.Wm)(c,{class:"zoom-button",icon:"pi pi-angle-double-left",disabled:(0,g.SU)(r),onClick:function(t){return d(e)}},null,8,["disabled","onClick"]),(0,o._)("p",$n,(0,f.zw)(e)+"x",1)])})),64)),ea]),(0,o._)("div",ta,[(0,o._)("p",na,(0,f.zw)(Math.round(100*a.value)/100)+"x",1)]),(0,o._)("div",aa,[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)(i,(function(e){return(0,o._)("div",{class:"zoom-options",key:e},[(0,o.Wm)(c,{class:"zoom-button",icon:"pi pi-angle-double-right",disabled:(0,g.SU)(r),onClick:function(t){return p(e)}},null,8,["disabled","onClick"]),(0,o._)("p",oa,(0,f.zw)(e)+"x",1)])})),64)),ia])])],64)}}}),ra=(0,s.Z)(sa,[["__scopeId","data-v-7152d558"]]),la=ra;var ca={class:"grid unpadded col-7"},ua={class:"col-12"},da=(0,o._)("h4",null,"Details",-1),pa={class:"grid unpadded"},va=(0,o._)("div",{class:"col-3"},"Displaying:",-1),ha={class:"col-9 bold"},ga=(0,o._)("div",{class:"col-3"},"Comparative Species:",-1),ba={class:"col-9 bold"},fa={class:"col-12"};const ma=(0,o.aZ)({__name:"DetailsControls",setup:function(e){var t=(0,S.oR)(w.J),n=(0,o.Fl)((function(){var e=t.state.selectedBackboneRegion;return e&&e.viewportSelection&&e.viewportSelection.svgHeight>0?"".concat(P.M.addCommasToBasePair(e.viewportSelection.basePairStart),"-").concat(P.M.addCommasToBasePair(e.viewportSelection.basePairStop)):""})),a=(0,o.Fl)((function(){var e="";return t.state.comparativeSpecies.forEach((function(t){e.length>0&&(e+=", "),e+="".concat(t.name," (").concat(t.activeMap.name,")")})),e}));return function(e,i){var s,r;return(0,o.wg)(),(0,o.iD)("div",ca,[(0,o._)("div",ua,[da,(0,o._)("div",pa,[va,(0,o._)("div",ha,(0,f.zw)(null===(s=(0,g.SU)(t).state.species)||void 0===s?void 0:s.name)+" chr"+(0,f.zw)(null===(r=(0,g.SU)(t).state.chromosome)||void 0===r?void 0:r.chromosome)+":"+(0,f.zw)((0,g.SU)(n)),1),ga,(0,o._)("div",ba,(0,f.zw)((0,g.SU)(a)),1),(0,o._)("div",fa,[(0,o.Wm)(la)])])])])}}}),ka=ma,Sa=ka;var ya=n(4970),wa={class:"header-container"},Pa={class:"col-12 backbone-info"},Za={class:"grid unpadded"},Ba=(0,o._)("div",{class:"col-5"},"Backbone:",-1),Da={class:"col-7 bold"},La=(0,o._)("div",{class:"col-5"},"Chromosome:",-1),xa={class:"col-7 bold"},Ua=(0,o._)("div",{class:"col-5"},"Assembly:",-1),Ca={class:"col-7 bold"},Ga=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"Comparative Species"),(0,o._)("th",null,"Assembly")])],-1),_a={class:"content-container"},Ma={class:"track-item-container"},Ya={class:"lg:col-1 md:col-2 sm:col-2"},Ia={class:"grid p-d-flex modal-controls-container"},Ha={class:"left-align-btn"};const Ta=(0,o.aZ)({__name:"LoadDataTrackControls",props:{header:null,message:null,show:{type:Boolean},theme:null,showBackButton:{type:Boolean},onConfirmCallback:null,onLoadSyntenyVariants:null,onCloseLoadDataTrackModal:null},emits:["update:show"],setup:function(e,t){var n=t.emit,a=e,i=(0,S.oR)(w.J),s=(0,g.iH)([]),r=(0,g.iH)([]);(0,o.bv)(v);var l=(0,o.Fl)({get:function(){return a.show},set:function(e){n("update:show",e)}}),c=function(){var e=[];s.value.forEach((function(t){t.species&&e.push(t.species.key)})),e.length>0&&(a.onCloseLoadDataTrackModal(),a.onLoadSyntenyVariants(e,!0),s.value.length=0)},u=function(){var e=s.value.length;e<i.state.comparativeSpecies.length+1?s.value.push({species:null}):Me.Z.error("Item Limit Reached")},d=function(){s.value.length=0,a.onCloseLoadDataTrackModal()};function p(e){s.value.splice(e,1)}function v(){var e=[];try{var t=i.state.species;t.label=t.name+": "+t.activeMap.name,e.push(t),i.state.comparativeSpecies.forEach((function(t){t.label=t.name+": "+t.activeMap.name,e.push(t)})),r.value=e}catch(n){Me.Z.error("An error occurred while loading available species"),Me.Z.error(n)}0!==r.value.length&&i.state.species}return function(e,t){var n=(0,o.up)("Button"),a=(0,o.up)("Dropdown"),v=(0,o.up)("Dialog");return(0,o.wg)(),(0,o.j4)(v,{visible:(0,g.SU)(l),"onUpdate:visible":t[0]||(t[0]=function(e){return(0,g.dq)(l)?l.value=e:null}),class:"data-track-dialog",draggable:!1,closable:!1,modal:!0},{header:(0,o.w5)((function(){var e,t,n;return[(0,o._)("div",wa,[(0,o._)("div",Pa,[(0,o._)("div",Za,[Ba,(0,o._)("div",Da,(0,f.zw)(null===(e=(0,g.SU)(i).state.species)||void 0===e?void 0:e.name),1),La,(0,o._)("div",xa,"chr"+(0,f.zw)(null===(t=(0,g.SU)(i).state.chromosome)||void 0===t?void 0:t.chromosome),1),Ua,(0,o._)("div",Ca,(0,f.zw)(null===(n=(0,g.SU)(i).state.species)||void 0===n?void 0:n.activeMap.name),1)])]),(0,o._)("div",null,[(0,o._)("table",null,[Ga,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,g.SU)(i).state.comparativeSpecies,(function(e,t){return(0,o.wg)(),(0,o.iD)("tr",{key:t},[(0,o._)("td",null,(0,f.zw)(e.name),1),(0,o._)("td",null,(0,f.zw)(e.activeMap.name),1)])})),128))])])])])]})),default:(0,o.w5)((function(){return[(0,o._)("div",_a,[(0,o.Wm)(n,{label:"Add Variants",icon:"pi pi-plus",class:"p-button-secondary p-button-sm add-track-btn",onClick:u}),(0,o._)("div",Ma,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.value,(function(e,t){return(0,o.wg)(),(0,o.iD)("div",{class:"grid track-item",key:t},[(0,o.Wm)(a,{modelValue:s.value[t].species,"onUpdate:modelValue":function(e){return s.value[t].species=e},options:r.value,optionValue:"activeMap",optionLabel:"label",placeholder:"Species"},null,8,["modelValue","onUpdate:modelValue","options"]),(0,o._)("div",Ya,[(0,o.Wm)(n,{onClick:function(e){return p(t)},label:"Remove",icon:"pi pi-minus-circle",class:"p-button-sm p-button-danger"},null,8,["onClick"])])])})),128))])]),(0,o._)("div",Ia,[(0,o._)("div",Ha,[(0,o.Wm)(n,{label:"Cancel",class:"p-button-danger",onClick:d})]),(0,o._)("div",null,[(0,o.Wm)(n,{label:"Load Tracks",class:"p-button-secondary",icon:"pi pi-arrow-right",onClick:c})])])]})),_:1},8,["visible"])}}}),Xa=Ta,Ra=Xa;var qa=function(e){return(0,o.dD)("data-v-0118bb31"),e=e(),(0,o.Cn)(),e},Ea={class:"grid"},Oa={class:"col-12"},Va={class:"vcmap-header"},za=qa((function(){return(0,o._)("img",{alt:"VCMap Logo",class:"logo",src:Pn},null,-1)})),Na={class:"icon-container"},Wa={href:"https://rgd.mcw.edu/",target:"_blank"},Aa={class:"rgd-logo",src:Zn,alt:"RGD logo"},Ka={class:"grid p-d-flex"};const Fa=(0,o.aZ)({__name:"HeaderPanel",props:{onLoadSyntenyVariants:null},setup:function(e){var t=e,n=(0,u.tv)(),a=(0,g.iH)(!1),i=function(){a.value=!0},s=function(){var e=(0,h.Z)((0,v.Z)().mark((function e(n,a){return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.onLoadSyntenyVariants(n,a);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r=function(){a.value=!1},l=function(){n.push("/")};return function(e,t){var n=(0,o.up)("Tag"),c=(0,o.up)("Button"),u=(0,o.up)("Divider"),d=(0,o.up)("Panel"),p=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",Ea,[(0,o._)("div",Oa,[(0,o.Wm)(d,{toggleable:!0,class:"vcmap-panel"},{header:(0,o.w5)((function(){return[(0,o._)("div",Va,[za,(0,o.Wm)(n,{icon:"pi pi-tag",severity:"info",rounded:""},{default:(0,o.w5)((function(){return[(0,o.Uk)("v"+(0,f.zw)((0,g.SU)(ya.q)),1)]})),_:1})])]})),icons:(0,o.w5)((function(){return[(0,o._)("div",Na,[(0,o._)("a",Wa,[(0,o.wy)((0,o._)("img",Aa,null,512),[[p,"Go to RGD Home Page",void 0,{bottom:!0}]])]),(0,o.Wm)(c,{label:"New Configuration",icon:"pi pi-cog",class:"p-button-secondary header-btn",onClick:l,"data-test":"load-config-btn"}),(0,o.Wm)(c,{label:"Load Data Track",class:"p-button-secondary header-btn",onClick:i,"data-test":"load-config-btn"})])]})),default:(0,o.w5)((function(){return[(0,o._)("div",Ka,[(0,o.Wm)(Fn),(0,o.Wm)(u,{layout:"vertical"}),(0,o.Wm)(Sa)])]})),_:1})])]),(0,o.Wm)(Ra,{show:(0,g.SU)(a),"onUpdate:show":t[0]||(t[0]=function(e){return(0,g.dq)(a)?a.value=e:a=e}),"on-load-synteny-variants":s,"on-close-load-data-track-modal":r,header:"Load Data Tracks"},null,8,["show"])],64)}}}),ja=(0,s.Z)(Fa,[["__scopeId","data-v-0118bb31"]]),Ja=ja;var Qa=function(e){return(0,o.dD)("data-v-49629d74"),e=e(),(0,o.Cn)(),e},$a={key:0},eo={class:"gene-row"},to={key:0,"data-test":"gene-name"},no={key:0},ao=Qa((function(){return(0,o._)("i",{class:"pi pi-external-link external-link"},null,-1)})),oo={key:0,"data-test":"species-name",class:"species-label"},io={"data-test":"chromosome-name"},so={"data-test":"start-stop"},ro={key:1},lo={key:2,"data-test":"level"};const co=(0,o.aZ)({__name:"GeneInfo",props:{gene:null,chromosome:null,start:null,stop:null,geneList:null,chainLevel:null,trackOrientation:null},setup:function(e){var t=e,n=(0,Le.wL)(),a=(0,S.oR)(w.J),i=3,s=function(e){if(null!=e){var o=e.stop-e.start;if(e.backboneStart&&e.backboneStop){var s=(0,K.UI)(a,e,t.geneList);a.dispatch("setSelectedGeneIds",[]),a.dispatch("setSelectedGeneIds",s.rgdIds),a.dispatch("setSelectedData",s.selectedData),null!=a.state.chromosome?a.dispatch("setDetailedBasePairRequest",{start:Math.max(e.backboneStart-o*i,0),stop:Math.min(e.backboneStop+o*i,a.state.chromosome.seqLength)}):n.error("Chromosome in state is null. Cannot dispatch setDetailedBasePairRequest action.")}}else n.warn("Selected gene is null")},r=function(e){var t="https://rgd.mcw.edu/rgdweb/report/gene/main.html?id=".concat(e);window.open(t)};return function(t,n){var a,i,l=(0,o.up)("Button"),c=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.iD)(o.HY,null,[e.gene?((0,o.wg)(),(0,o.iD)("div",$a,[(0,o._)("div",eo,[(0,o._)("div",null,[(0,o.Wm)(l,{class:"p-button-link rgd-link",onClick:n[0]||(n[0]=function(t){return s(e.gene)})},{default:(0,o.w5)((function(){return[(0,o._)("b",null,(0,f.zw)(e.gene.symbol),1)]})),_:1}),e.gene?((0,o.wg)(),(0,o.iD)("span",to,"("+(0,f.zw)(null!==(a=e.gene.name)&&void 0!==a?a:"N/A")+")",1)):(0,o.kq)("",!0)]),null!=e.gene?((0,o.wg)(),(0,o.iD)("div",no,[(0,o.wy)(((0,o.wg)(),(0,o.j4)(l,{class:"p-button-link rgd-link",onClick:n[1]||(n[1]=function(t){return r(e.gene.rgdId)})},{default:(0,o.w5)((function(){return[ao]})),_:1})),[[c,"View in RGD",void 0,{left:!0}]])])):(0,o.kq)("",!0)])])):(0,o.kq)("",!0),(0,o._)("div",null,[e.gene?((0,o.wg)(),(0,o.iD)("span",oo,(0,f.zw)(null!==(i=e.gene.speciesName)&&void 0!==i?i:"N/A"),1)):(0,o.kq)("",!0),(0,o._)("span",io,"Chr"+(0,f.zw)(e.chromosome)+": ",1),(0,o._)("span",so,(0,f.zw)((0,g.SU)(P.M).addCommasToBasePair(e.start))+" - "+(0,f.zw)((0,g.SU)(P.M).addCommasToBasePair(e.stop)),1)]),e.trackOrientation?((0,o.wg)(),(0,o.iD)("div",ro,"Orientation: "+(0,f.zw)(e.trackOrientation),1)):(0,o.kq)("",!0),e.chainLevel?((0,o.wg)(),(0,o.iD)("div",lo," Level: "+(0,f.zw)(e.chainLevel),1)):(0,o.kq)("",!0)],64)}}}),uo=(0,s.Z)(co,[["__scopeId","data-v-49629d74"]]),po=uo;var vo=function(e){return(0,o.dD)("data-v-c8962e14"),e=e(),(0,o.Cn)(),e},ho={class:"selected-data-header"},go=vo((function(){return(0,o._)("div",{class:"panel-header-item"},[(0,o._)("b",null,"Selected Data")],-1)})),bo={class:"panel-header-item"},fo={class:"panel-header-item"},mo={key:0},ko={class:"clear-selection-btn"},So={class:"gene-data"},yo={key:0,class:"no-data"},wo=vo((function(){return(0,o._)("p",{class:"placeholder-msg"},"No data selected",-1)})),Po=vo((function(){return(0,o._)("p",{class:"placeholder-msg-txt"},"Select data by clicking or hovering drawn elements, or searching by gene symbol above",-1)})),Zo=[wo,Po];const Bo=(0,o.aZ)({__name:"SelectedDataPanel",props:{selectedData:null,geneList:null},setup:function(e){var t=e,n=(0,S.oR)(w.J),a=(0,g.iH)(null),i=(0,g.iH)([]),s=(0,g.iH)(0);(0,o.YP)((function(){return t.selectedData}),(function(){s.value=0,null!=t.selectedData&&(s.value=t.selectedData.filter((function(e){return"Gene"===e.type})).length)}));var r=function(){n.dispatch("setSelectedGeneIds",[]),n.dispatch("setSelectedData",null),n.dispatch("setGene",null),a.value=null},l=function(e){var n=[];t.geneList.forEach((function(t){t.symbol.toLowerCase().includes(e.query.toLowerCase())&&n.push(t)}));var o=a.value;n=(0,K.CK)(o,n),i.value=n},c=function(e){var a=(0,K.UI)(n,e.value,t.geneList);if(n.dispatch("setGene",e.value.clone()),n.dispatch("setSelectedGeneIds",a.rgdIds||[]),n.dispatch("setSelectedData",a.selectedData),e.value){var o=(0,K.EJ)(e.value,t.geneList,n);n.dispatch("setDetailedBasePairRequest",o)}},u=function(e){return"".concat(e.symbol," - ").concat(e.speciesName)};return function(n,d){var p=(0,o.up)("AutoComplete"),v=(0,o.up)("Button"),h=(0,o.up)("Divider"),b=(0,o.up)("Panel"),m=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.j4)(b,null,{header:(0,o.w5)((function(){return[(0,o._)("div",ho,[go,(0,o._)("div",bo,[(0,o.Wm)(p,{modelValue:a.value,"onUpdate:modelValue":d[0]||(d[0]=function(e){return a.value=e}),suggestions:i.value,onComplete:d[1]||(d[1]=function(e){return l(e)}),onItemSelect:d[2]||(d[2]=function(e){return c(e)}),field:u,minLength:3,placeholder:"Search loaded genes..."},null,8,["modelValue","suggestions"])]),(0,o._)("div",fo,[s.value>0?((0,o.wg)(),(0,o.iD)("div",mo,(0,f.zw)(s.value)+" Selected Genes ",1)):(0,o.kq)("",!0),(0,o._)("div",ko,[(0,o.wy)((0,o.Wm)(v,{class:"p-button-info p-button-sm p-button-warning",icon:"pi pi-ban",onClick:r,rounded:""},null,512),[[m,"Clear Selection",void 0,{right:!0}]])])])])]})),default:(0,o.w5)((function(){return[(0,o._)("div",So,[t.selectedData&&0!==t.selectedData.length?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",yo,Zo)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.selectedData,(function(t){return(0,o.wg)(),(0,o.iD)(o.HY,{key:t},["Gene"===t.type?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(po,{gene:t.genomicSection.gene?t.genomicSection.gene:t.genomicSection,chromosome:t.genomicSection.chromosome?t.genomicSection.chromosome:t.genomicSection.gene.chromosome,start:t.genomicSection.speciesStart?t.genomicSection.speciesStart:t.genomicSection.start,stop:t.genomicSection.speciesStop?t.genomicSection.speciesStop:t.genomicSection.stop,"gene-list":e.geneList},null,8,["gene","chromosome","start","stop","gene-list"]),(0,o.Wm)(h)],64)):"trackSection"===t.type||"backbone"===t.type||"variantDensity"===t.type?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},["trackSection"===t.type?((0,o.wg)(),(0,o.j4)(po,{key:0,gene:null!==t&&void 0!==t&&t.genomicSection.gene?null===t||void 0===t?void 0:t.genomicSection.gene:null,chromosome:t.genomicSection.chromosome,start:t.genomicSection.speciesStart,stop:t.genomicSection.speciesStop,"chain-level":t.genomicSection.chainLevel,"track-orientation":t.genomicSection.isInverted?"-":"+","gene-list":e.geneList},null,8,["gene","chromosome","start","stop","chain-level","track-orientation","gene-list"])):"backbone"===t.type?((0,o.wg)(),(0,o.j4)(po,{key:1,gene:null,chromosome:t.genomicSection.chromosome,start:t.genomicSection.windowStart,stop:t.genomicSection.windowStop,"track-orientation":"+","gene-list":e.geneList},null,8,["chromosome","start","stop","gene-list"])):"variantDensity"===(null===t||void 0===t?void 0:t.type)?((0,o.wg)(),(0,o.iD)(o.HY,{key:2},[(0,o._)("div",null,[(0,o._)("span",null,"Chr"+(0,f.zw)(t.genomicSection.chromosome)+": ",1),(0,o._)("span",null,(0,f.zw)((0,g.SU)(P.M).addCommasToBasePair(t.genomicSection.speciesStart))+" - "+(0,f.zw)((0,g.SU)(P.M).addCommasToBasePair(t.genomicSection.speciesStop)),1)]),(0,o._)("div",null,[(0,o._)("span",null,"Variant Count: "+(0,f.zw)((0,g.SU)(P.M).addCommasToBasePair(t.genomicSection.variantCount)),1)])],64)):(0,o.kq)("",!0),(0,o.Wm)(h)],64)):(0,o.kq)("",!0)],64)})),128))])]})),_:1})}}}),Do=(0,s.Z)(Bo,[["__scopeId","data-v-c8962e14"]]),Lo=Do;var xo=(0,Ge.Z)((function e(t){(0,Ce.Z)(this,e),this.start=-1,this.stop=-1,this.backboneStart=-1,this.backboneStop=-1,this.chainLevel=1,this.start=t.start,this.stop=t.stop,this.backboneStart=t.backboneStart,this.backboneStop=t.backboneStop,this.chainLevel=t.chainLevel})),Uo=function(){function e(t){var n,a,o,i,s,r;(0,Ce.Z)(this,e),this.chainLevel=1,this.start=0,this.stop=0,this.backboneStart=-1,this.backboneStop=-1,this.orientation="+",this.gaps=[],this.genes=[],this.backbone=t.backbone,this.chromosome=t.chromosome,this.chainLevel=null!==(n=t.chainLevel)&&void 0!==n?n:this.chainLevel,this.start=t.start,this.stop=t.stop,this.backboneStart=null!==(a=t.backboneStart)&&void 0!==a?a:this.backboneStart,this.backboneStop=null!==(o=t.backboneStop)&&void 0!==o?o:this.backboneStop,this.orientation=null!==(i=t.orientation)&&void 0!==i?i:this.orientation,this.gaps=null!==(s=t.gaps)&&void 0!==s?s:this.gaps,this.genes=null!==(r=t.genes)&&void 0!==r?r:this.genes}return(0,Ge.Z)(e,[{key:"addGaps",value:function(e,t,n){for(var a=this.gaps.length,o=0,i=e.length;o<i;o++)if(!(e[o].backboneStart>n||e[o].backboneStop<t)){for(var s=!1,r=!1,l=0,c=this.gaps.length;l<c;l++){if(this.gaps[l].start===e[o].start&&this.gaps[l].stop===e[o].stop){s=!0;break}if(this.gaps[l].start>e[o].start){r=!0,this.gaps.push(new xo({start:e[o].start,stop:e[o].stop,backboneStart:e[o].backboneStart,backboneStop:e[o].backboneStop,chainLevel:e[o].chainLevel}));break}}s||r||this.gaps.push(new xo({start:e[o].start,stop:e[o].stop,backboneStart:e[o].backboneStart,backboneStop:e[o].backboneStop,chainLevel:e[o].chainLevel}))}a<this.gaps.length&&this.gaps.sort((function(e,t){var n=e.start-t.start;return 0==n?e.stop-t.stop:n}))}},{key:"isBlockInverted",value:function(){return"-"===this.orientation}}]),e}(),Co=(n(5827),n(7941),n(8583));function Go(e,t){var n;return new Co.Z({mapKey:e.mapKey,speciesName:t,symbol:e.geneSymbol,name:e.geneName,rgdId:e.geneRgdId,chromosome:e.chr,start:e.startPos,stop:e.stopPos,orthologs:null!==(n=e.orthologs)&&void 0!==n?n:[]})}function _o(e,t){var n=[];e.forEach((function(e){var a,o,i=[];null===(a=e.genes)||void 0===a||a.forEach((function(e){i.push(Go(e,t.name))})),n.push({block:e.block,gaps:null!==(o=e.gaps)&&void 0!==o?o:[],genes:null!==i&&void 0!==i?i:[]})}));var a=n.length>0?n.map((function(e){return e.genes})):[];return{speciesName:t.name,mapName:t.activeMap.name,mapKey:t.activeMap.key,regionData:n,allGenes:a.length>0?a.reduce((function(e,t){return e.concat(t)})):[]}}var Mo=function(){function e(){(0,Ce.Z)(this,e)}return(0,Ge.Z)(e,null,[{key:"getSyntenicRegions",value:function(){var e=(0,h.Z)((0,v.Z)().mark((function e(t){var n,a,o,i,s,r,l;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Date.now(),e.prev=1,a=[],o=t.comparativeSpecies.map((function(e){return e.activeMap})),i=Math.round(t.start),s=Math.round(t.stop),o.forEach((function(e){var n,o,r="/vcmap/synteny/".concat(null===(n=t.backboneChromosome)||void 0===n?void 0:n.mapKey,"/").concat(null===(o=t.backboneChromosome)||void 0===o?void 0:o.chromosome,"/").concat(i,"/").concat(s,"/").concat(e.key),l=0;Object.keys(t.optional).length>0&&(r+="?",null!=t.optional.threshold&&t.optional.threshold>0&&(r+="threshold=".concat(t.optional.threshold),l++),t.optional.includeGenes&&(r+=l>0?"&includeGenes=1":"includeGenes=1",l++),t.optional.thresholdStart&&(r+=l>0?"&thresholdStart=".concat(t.optional.thresholdStart):"thresholdStart=".concat(t.optional.thresholdStart),l++),t.optional.thresholdEnd&&(r+=l>0?"&thresholdEnd=".concat(t.optional.thresholdEnd):"thresholdEnd=".concat(t.optional.thresholdEnd),l++),t.optional.includeOrthologs&&(r+=l>0?"&includeOrthologs=1":"includeOrthologs=1",l++)),a.push(tt.Z.get(r))})),e.next=9,Promise.allSettled(a);case 9:return r=e.sent,l=[],r.forEach((function(e,n){if("fulfilled"===e.status){var a=_o(e.value.data,t.comparativeSpecies[n]);Me.Z.debug("Syntenic regions found: ".concat(a.regionData.length," ")+"[mapKey: '".concat(a.mapKey,"', threshold: '").concat(t.optional.threshold,"']")),l.push(a)}else Me.Z.error(e.status,e.reason)})),Me.Z.debug("Synteny API: ".concat(Date.now()-n," ms"),t.backboneChromosome.chromosome,t.start,t.stop,t.optional.threshold),e.abrupt("return",l);case 16:e.prev=16,e.t0=e["catch"](1),Me.Z.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),Yo=n(8600),Io=new Error("Cannot render the overview panel without valid species, chromosome, and start/stop for the backbone"),Ho=(new Error("Cannot render the detailed panel without valid species and chromosome for the backbone"),new Error("Region length must be greater than zero")),To=new Error("Cannot load synteny without any comparative species maps selected"),Xo=(new Error("An error occurred while making a selection"),new Error("No syntenic regions were found for the selected species and base pair range.")),Ro={class:"grid"},qo={class:"col-9"},Eo={class:"col-3"};const Oo=(0,o.aZ)({__name:"Main",setup:function(e){var t=2,n=1,a=(0,S.oR)(w.J),i=(0,Le.wL)(),s=(0,St.p)(),r=xe(),l=r.showDialog,c=r.dialogHeader,u=r.dialogMessage,b=r.showDialogBackButton,f=r.dialogTheme,m=r.onError,k=(0,g.iH)(!1),y=(0,g.iH)(!1),P=(0,g.iH)(new Map),Z=(0,g.iH)(new Map),B=(0,g.iH)([]);function D(){return L.apply(this,arguments)}function L(){return L=(0,h.Z)((0,v.Z)().mark((function e(){var t,n,o,s,r,l,c,u,d,p,h,g,b;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(k.value=!0,i.debug("Creating memory models for our Comparative Map view"),a.dispatch("setConfigurationLoaded",!1),P.value=new Map,Z.value=new Map,!_()){e.next=8;break}return k.value=!1,e.abrupt("return");case 8:if(a.state.chromosome&&a.state.species){e.next=11;break}return k.value=!1,e.abrupt("return");case 11:return t=setTimeout((function(){T("warn","Loading Impact","API is taking a while to respond, please be patient",5e3)}),15e3),n=[],a.state.comparativeSpecies.map((function(e){return n.push(e.defaultMapKey)})),e.next=16,Yo.Z.getGenesByRegion(a.state.chromosome.chromosome,0,a.state.chromosome.seqLength,a.state.species.activeMap.key,a.state.species.name,n);case 16:return o=e.sent,o.forEach((function(e){Z.value.set(e.rgdId,e)})),s=(0,ve.zQ)(a.state.chromosome.seqLength),e.next=21,Mo.getSyntenicRegions({backboneChromosome:a.state.chromosome,start:0,stop:a.state.chromosome.seqLength,optional:{includeGenes:!0,includeOrthologs:!0,threshold:s},comparativeSpecies:a.state.comparativeSpecies});case 21:if(r=e.sent,void 0!=r){e.next=27;break}return i.error("SpeciesSyntenyDataArray is undefined after querying for syntenic regions"),k.value=!1,clearTimeout(t),e.abrupt("return");case 27:if(y.value||!I(r)){e.next=31;break}return k.value=!1,clearTimeout(t),e.abrupt("return");case 31:if(clearTimeout(t),l=setTimeout((function(){var e="";e=a.state.comparativeSpecies.length>2?"Currently processing data, please be patient. Longer times may be due to the large number of species in the selected region":"Currently processing data, please be patient. Longer times may be due due to the large number of genes in the selected region",T("warn","Loading Impact",e,5e3)}),3e3),x(r,0,a.state.chromosome.seqLength),c=0,u=a.state.chromosome.seqLength,a.getters.isLoadByGene&&null!=a.state.gene?(d=a.state.gene,p=(0,K.EJ)(d,Z.value,a),c=p.start,u=p.stop,h=(0,K.UI)(a,d,Z.value),g=h.rgdIds,b=h.selectedData,i.debug("Auto-selecting genes for Load by Gene",g),a.dispatch("setSelectedGeneIds",g),a.dispatch("setSelectedData",b)):a.getters.isLoadByPosition&&null!=a.state.startPos&&null!=a.state.stopPos&&(c=Math.max(0,a.state.startPos),u=Math.min(a.state.stopPos,a.state.chromosome.seqLength)),0===c&&u===a.state.chromosome.seqLength){e.next=40;break}return e.next=40,U(a.state.chromosome,c,u);case 40:a.dispatch("setConfigurationLoaded",!0),G(a.state.chromosome,c,u),clearTimeout(l),k.value=!1;case 44:case"end":return e.stop()}}),e)}))),L.apply(this,arguments)}function x(e,o,s){if(e)if(a.state.chromosome){var r=P.value,l=a.state.chromosome;i.debug("Processing ".concat(e.length," species of Synteny Data..."));for(var c=0;c<e.length;c++){var u;r.has(e[c].mapKey)||r.set(e[c].mapKey,[]);var d=null!==(u=r.get(e[c].mapKey))&&void 0!==u?u:[];i.debug("  Processing ".concat(e[c].regionData.length," blocks of Synteny Data..."));for(var p=function(a,r){var u=e[c].regionData[a];if(i.debug("  Processing block with ".concat(u.gaps.length," gaps, and ").concat(u.genes.length," genes...")),u.block.chainLevel>t)return"continue";if(u.block.backboneStart>s||u.block.backboneStop<o)return"continue";var p=null,v=d.filter((function(e){return e.chainLevel==u.block.chainLevel&&e.backboneStart==u.block.backboneStart&&e.backboneStop==u.block.backboneStop})),h=!1;if(0==v.length){i.debug("Found new Synteny block for ".concat(e[c].speciesName," (chr ").concat(u.block.chromosome,")"));var g=new Uo({backbone:l,chromosome:new Je.Z({mapKey:u.block.mapKey,chromosome:u.block.chromosome}),chainLevel:u.block.chainLevel,orientation:u.block.orientation,backboneStart:u.block.backboneStart,backboneStop:u.block.backboneStop,start:u.block.start,stop:u.block.stop});i.time("AddGapsNewBlock"),g.addGaps(u.gaps,o,s),i.timeEnd("AddGapsNewBlock"),d.push(g),p=g}else if(1==v.length){var b;p=v[0],h=p.gaps.length!==u.gaps.length;var f="AddGapsExistingBlock(".concat(p.gaps.length,", ").concat(u.gaps.length,")");i.time(f),null===(b=p)||void 0===b||b.addGaps(u.gaps,o,s),i.timeEnd(f)}else i.error("OH NO! Discovered duplicate blocks in our tree!");if(u.block.chainLevel>n)return i.log("Skipping ".concat(u.genes.length," genes due to chain level filter")),"continue";i.time("ProcessGenesForBlock");for(var m=0,k=u.genes.length;m<k;m++){var S,y=u.genes[m],w=null!==(S=Z.value.get(y.rgdId))&&void 0!==S?S:y;if(null===w.block&&p){var P=(0,ve.Oo)(p,o,s)?(0,ve.uZ)(w.start,w.stop,p):(0,ve.go)(w.start,w.stop,p);w.backboneStart=P.start,w.backboneStop=P.stop,w.block=p,p.genes.push(w)}else if(w.block&&p&&h&&(0,ve.Oo)(p,o,s)){var B=(0,ve.uZ)(w.start,w.stop,p);w.backboneStart=B.start,w.backboneStop=B.stop}w&&!Z.value.get(w.rgdId)&&Z.value.set(w.rgdId,w)}i.timeEnd("ProcessGenesForBlock")},v=0,h=e[c].regionData.length;v<h;v++)p(v,h)}}else i.error("Process Synteny called without a Chromosome on the state");else i.debug("Process Synteny called without an array of SpeciesSyntenyData (check API response)")}function U(e,t,n){return C.apply(this,arguments)}function C(){return C=(0,h.Z)((0,v.Z)().mark((function e(t,n,o){var s,r,l,c,u,d,h,g;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i.debug("Querying for specific base pair range: ".concat(n," - ").concat(o)),s=setTimeout((function(){i.log("API is taking longer than usual to respond..."),T("warn","Loading Impact","API is taking a while to respond, please be patient",5e3)}),15e3),r=(0,ve.zQ)(o-n),e.next=5,Mo.getSyntenicRegions({backboneChromosome:t,start:n,stop:o,optional:{includeGenes:!0,includeOrthologs:!0,threshold:r},comparativeSpecies:a.state.comparativeSpecies});case 5:l=e.sent,clearTimeout(s),x(l,n,o),c=P.value.keys(),u=(0,p.Z)(c);try{for(u.s();!(d=u.n()).done;)h=d.value,g=P.value.get(h),g&&g.some((function(e){return e.variantPositions}))&&q([h],!1)}catch(v){u.e(v)}finally{u.f()}case 11:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function G(e,t,n){var o=a.state.selectedBackboneRegion;o=new Lt(e),o.setViewportSelection(t,n),a.dispatch("setBackboneSelection",o)}function _(){return null==a.state.chromosome||null==a.state.species?(m(Io,Io.message,!1),!0):a.getters.isLoadByPosition&&(null==a.state.startPos||null==a.state.stopPos||a.state.stopPos-a.state.startPos<=0)?(m(Ho,Ho.message,!1),!0):0===a.state.comparativeSpecies.length&&(m(To,To.message,!1),!0)}function M(){m(Xo,Xo.message,!0,"No Results")}function Y(e){var t="We did not find syntenic regions for the following species: ".concat(e.map((function(e){return"".concat(e.speciesName," (").concat(e.mapName,")")})).join(", "));m(new Error(t),t,!0,"Missing Results")}function I(e){var t=e.some((function(e){return e.regionData.length>0}));if(!t)return M(),!0;if(e.some((function(e){return 0===e.regionData.length}))){var n=e.filter((function(e){return 0===e.regionData.length}));return Y(n),!0}return!1}function H(){y.value=!0,D()}function T(e,t,n,a){s.add({severity:e,summary:t,detail:n,life:a})}function X(){return R.apply(this,arguments)}function R(){return R=(0,h.Z)((0,v.Z)().mark((function e(){var t,n,o,i,s,r,l,c,u;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(k.value=!0,o=a.state.chromosome,i=a.state.species,s=a.state.selectedBackboneRegion,r=null===s||void 0===s||null===(t=s.viewportSelection)||void 0===t?void 0:t.basePairStop,l=null===(n=a.state.species)||void 0===n?void 0:n.activeMap,!(o&&r&&l&&i)){e.next=13;break}if(c=B.value.findIndex((function(e){return e.mapKey===l.key&&0===e.blockStart&&e.blockStop===o.seqLength})),-1!==c){e.next=13;break}return e.next=11,st(o.chromosome,0,o.seqLength,0,o.seqLength,l.key);case 11:u=e.sent,u.positions.length>0?B.value.push(u):T("warn","No Variants Found","There were no variants found for the given chromosome",5e3);case 13:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}function q(e,t){return E.apply(this,arguments)}function E(){return E=(0,h.Z)((0,v.Z)().mark((function e(t,n){var o,i,s;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return a.dispatch("setIsUpdatingVariants",!1),k.value=!0,o=!1,i=!1,s=[],s.push.apply(s,(0,d.Z)(t.map(function(){var e=(0,h.Z)((0,v.Z)().mark((function e(t){var n,s,r;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t!==(null===(n=a.state.chromosome)||void 0===n?void 0:n.mapKey)){e.next=7;break}return o=!0,e.next=4,X();case 4:return e.abrupt("return");case 7:if(s=P.value.get(t),!s){e.next=13;break}return r=s.map(function(){var e=(0,h.Z)((0,v.Z)().mark((function e(t){var n;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.variantPositions){e.next=5;break}return i=!0,e.abrupt("return");case 5:if(1!==t.chainLevel){e.next=11;break}return e.next=8,st(t.chromosome.chromosome,t.start,t.stop,t.backboneStart,t.backboneStop,t.chromosome.mapKey);case 8:return n=e.sent,n&&(!i&&n.positions.length>0&&(i=!0),t.variantPositions=n),e.abrupt("return");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=12,Promise.allSettled(r);case 12:return e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))),e.next=10,Promise.allSettled(s);case 10:k.value=!1,i||o||T("warn","No Variants Found","There were no variants found for the given regions.",5e3),n&&a.dispatch("setIsUpdatingVariants",!0);case 13:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}return(0,o.bv)(D),(0,o.YP)((function(){return a.state.detailedBasePairRequest}),(0,h.Z)((0,v.Z)().mark((function e(){var t,n;return(0,v.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(k.value=!0,!(a.state.detailedBasePairRequest&&a.state.chromosome&&a.state.species)){e.next=9;break}return i.debug("Detailed Base Pair range change request detected (".concat(null===(t=a.state.detailedBasePairRequest)||void 0===t?void 0:t.start,",\n       ").concat(null===(n=a.state.detailedBasePairRequest)||void 0===n?void 0:n.stop,").")),e.next=5,U(a.state.chromosome,a.state.detailedBasePairRequest.start,a.state.detailedBasePairRequest.stop);case 5:G(a.state.chromosome,a.state.detailedBasePairRequest.start,a.state.detailedBasePairRequest.stop),a.dispatch("setDetailedBasePairRequest",null),e.next=10;break;case 9:null!=a.state.chromosome&&null!=a.state.species||i.error("DetailedBasePairRequest: Missing data required for querying and processing synteny",a.state.chromosome,a.state.species);case 10:k.value=!1;case 11:case"end":return e.stop()}}),e)})))),function(e,t){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(Ja,{"on-load-synteny-variants":q}),(0,o._)("div",Ro,[(0,o._)("div",qo,[(0,o.Wm)(wn,{geneList:Z.value,"synteny-tree":P.value,loading:k.value,"variant-positions-list":B.value},null,8,["geneList","synteny-tree","loading","variant-positions-list"]),(0,o.Wm)((0,g.SU)(kt.Z))]),(0,o._)("div",Eo,[(0,o.Wm)(Lo,{"selected-data":(0,g.SU)(a).state.selectedData,"gene-list":Z.value},null,8,["selected-data","gene-list"])])]),(0,o.Wm)(le.Z,{show:(0,g.SU)(l),"onUpdate:show":t[0]||(t[0]=function(e){return(0,g.dq)(l)?l.value=e:null}),header:(0,g.SU)(c),message:(0,g.SU)(u),theme:(0,g.SU)(f),"show-back-button":(0,g.SU)(b),"on-confirm-callback":H},null,8,["show","header","message","theme","show-back-button"])],64)}}}),Vo=Oo,zo=Vo;var No=[{path:"/main",name:"Main",component:zo},{path:"/",name:"Configuration",component:function(){return n.e(639).then(n.bind(n,9962))}}],Wo=(0,u.p7)({history:(0,u.PO)("/vcmap/"),routes:No});const Ao=Wo;var Ko,Fo=n(5475),jo=n(7382),Jo=n(4325),Qo=n(6635),$o=n(3736),ei=n(3242),ti=n(1655),ni=n(7915),ai=n(161),oi=n(1895),ii=n(445),si=n(3236),ri=n(6781),li=n(5876),ci=n(9292),ui=n(2124),di=n(1239),pi=n(4456),vi=n(4005),hi=n(9151),gi=[Fo.Z,jo.Z],bi={Button:Jo.Z,Dropdown:Qo.Z,InputNumber:$o.Z,Divider:ei.Z,Panel:ti.Z,ProgressBar:ai.Z,ProgressSpinner:oi.Z,TabView:ii.Z,TabPanel:si.Z,AutoComplete:ri.Z,Checkbox:li.Z,ColorPicker:ci.Z,Message:ui.Z,InlineMessage:di.Z,Dialog:pi.Z,Slider:vi.Z,Toast:kt.Z,Tag:hi.Z},fi={Tooltip:ni.Z};(function(e){function t(e){for(var t in gi.forEach((function(t){e.use(t)})),bi)e.component(t,bi[t]);for(var n in fi)e.directive(n,fi[n])}function n(){return gi}function a(){return bi}function o(){return fi}e.registerAll=t,e.getPlugins=n,e.getComponents=a,e.getDirectives=o})(Ko||(Ko={}));var mi=(0,a.ri)(c).use(Me.Z).use(w.Z,w.J).use(Ao);Ko.registerAll(mi),mi.mount("#app")},9644:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(3087),o=n(2833),i={1:"#ff7e76",2:"#fec27e",3:"#fde083",4:"#91ff87",5:"#a4c2ff",6:"#e289ff",7:"#c2c280",8:"#c2c2c2",9:"#ff7de2",10:"#e47773",11:"#ffe0e1",12:"#fcff89",13:"#e0ff88",14:"#89b374",15:"#6666e2",16:"#c3e0ff",17:"#91ffff",18:"#e0ffff",19:"#c572e2",20:"#e0c2ff",21:"#c3a374",22:"#a3a371",X:"#a3a3a3",Y:"#e0e0e0",MT:"#b2e190","2A":"#e0e0c2","2B":"#a52a2a"},s="#a52a2a",r=function(){function e(t){(0,a.Z)(this,e),this.mapKey=0,this.chromosome="",this.seqLength=0,this.mapKey=t.mapKey,this.chromosome=t.chromosome,this.seqLength=t.seqLength||0}return(0,o.Z)(e,null,[{key:"getColor",value:function(e){var t;return null!==(t=i[e])&&void 0!==t?t:s}}]),e}()},8583:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(3087),o=n(2833),i=(n(8309),function(){function e(t){var n,o,i,s,r;(0,a.Z)(this,e),this.speciesName="",this.symbol="",this.name="",this.rgdId=0,this.chromosome="",this.start=0,this.stop=0,this.backboneStart=0,this.backboneStop=0,this.orthologs=[],this.block=null,this.mapKey=t.mapKey,this.speciesName=null!==(n=t.speciesName)&&void 0!==n?n:this.speciesName,this.symbol=t.symbol,this.name=t.name,this.rgdId=t.rgdId,this.chromosome=t.chromosome,this.start=t.start,this.stop=t.stop,this.backboneStart=null!==(o=t.backboneStart)&&void 0!==o?o:this.backboneStart,this.backboneStop=null!==(i=t.backboneStop)&&void 0!==i?i:this.backboneStop,this.orthologs=null!==(s=t.orthologs)&&void 0!==s?s:[],this.block=null!==(r=t.block)&&void 0!==r?r:this.block}return(0,o.Z)(e,[{key:"clone",value:function(){var t=new e({mapKey:this.mapKey,speciesName:this.speciesName,symbol:this.symbol,name:this.name,rgdId:this.rgdId,chromosome:this.chromosome,start:this.start,stop:this.stop});return this.backboneStart&&(t.backboneStart=this.backboneStart),this.backboneStop&&(t.backboneStop=this.backboneStop),t}},{key:"size",get:function(){return Math.abs(this.stop-this.start)}}]),e}())},8561:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(2833),o=n(3087),i=(0,a.Z)((function e(t,n){(0,o.Z)(this,e),this.genomicSection=t,this.type=n}))},7627:(e,t,n)=>{n.d(t,{J:()=>i,Z:()=>c});n(2526),n(1817),n(1539),n(6699);var a=n(3907),o=n(3168),i=Symbol(),s=new o.ZP({storage:window.localStorage}),r=["setDetailedBasePairRange","setDetailedBasePairRequest"],l=["detailedBasePairRange"];(0,a.hu)({filter:function(e){return l.includes(e.type)},actionFilter:function(e){return r.includes(e.type)}});const c=(0,a.MT)({state:function(){var e;return{species:null,chromosome:null,startPos:null,stopPos:null,gene:null,comparativeSpecies:[],configMode:"gene",configurationLoaded:null,selectedBackboneRegion:null,detailedBasePairRequest:null!==(e={start:0,stop:0})&&void 0!==e?e:null,detailedBasePairRange:{start:0,stop:0},isDetailedPanelUpdating:!1,isOverviewPanelUpdating:!1,isUpdatingVariants:!1,selectedGeneIds:[],selectedData:null,selectionToastCount:0,loadedGenes:null}},mutations:{species:function(e,t){e.species=t},chromosome:function(e,t){e.chromosome=t},startPosition:function(e,t){e.startPos=t},stopPosition:function(e,t){e.stopPos=t},gene:function(e,t){e.gene=t},comparativeSpecies:function(e,t){e.comparativeSpecies=t},loadedGenes:function(e,t){e.loadedGenes=t},configurationLoaded:function(e,t){e.configurationLoaded=t},selectedBackboneRegion:function(e,t){e.selectedBackboneRegion=t},detailedBasePairRequest:function(e,t){e.detailedBasePairRequest=t},detailedBasePairRange:function(e,t){e.detailedBasePairRange=t},configMode:function(e,t){e.configMode=t},selectedData:function(e,t){e.selectedData=t},selectedGeneIds:function(e,t){e.selectedGeneIds=t},isDetailedPanelUpdating:function(e,t){e.isDetailedPanelUpdating=t},isOverviewPanelUpdating:function(e,t){e.isOverviewPanelUpdating=t},isUpdatingVariants:function(e,t){e.isUpdatingVariants=t},selectionToastCount:function(e,t){e.selectionToastCount=t}},actions:{setSpecies:function(e,t){e.commit("species",t)},setChromosome:function(e,t){e.commit("chromosome",t)},setStartPosition:function(e,t){e.commit("startPosition",t)},setStopPosition:function(e,t){e.commit("stopPosition",t)},setGene:function(e,t){e.commit("gene",t)},setConfigMode:function(e,t){e.commit("configMode",t)},setConfigurationLoaded:function(e,t){e.commit("configurationLoaded",t)},setSelectedData:function(e,t){e.commit("selectedData",t)},setSelectedGeneIds:function(e,t){e.commit("selectedGeneIds",t)},setComparativeSpecies:function(e,t){e.commit("comparativeSpecies",t)},setLoadedGenes:function(e,t){e.commit("loadedGenes",t)},setIsDetailedPanelUpdating:function(e,t){e.commit("isDetailedPanelUpdating",t)},setIsOverviewPanelUpdating:function(e,t){e.commit("isOverviewPanelUpdating",t)},setIsUpdatingVariants:function(e,t){e.commit("isUpdatingVariants",t)},clearConfiguration:function(e){e.commit("species",null),e.commit("gene",null),e.commit("chromosome",null),e.commit("startPosition",null),e.commit("stopPosition",null),e.commit("comparativeSpecies",[]),e.commit("selectedGeneIds",[]),e.commit("loadedGenes",null),e.commit("loadedBlocks",null),e.commit("selectedBackboneRegion",null),e.commit("detailedBasePairRange",{start:0,stop:0}),e.commit("configurationLoaded",null),e.commit("selectionToastCount",0)},clearBackboneSelection:function(e){e.commit("selectedBackboneRegion",null),e.commit("detailedBasePairRange",{start:0,stop:0})},setBackboneSelection:function(e,t){var n,a,o,i,s,r;null==t.viewportSelection&&t.setViewportSelection(0,t.chromosome.seqLength),e.commit("startPosition",null!==(n=null===(a=t.viewportSelection)||void 0===a?void 0:a.basePairStart)&&void 0!==n?n:0),e.commit("stopPosition",null!==(o=null===(i=t.viewportSelection)||void 0===i?void 0:i.basePairStop)&&void 0!==o?o:t.chromosome.seqLength),e.commit("selectedBackboneRegion",t),e.commit("detailedBasePairRange",{start:null===(s=t.viewportSelection)||void 0===s?void 0:s.basePairStart,stop:null===(r=t.viewportSelection)||void 0===r?void 0:r.basePairStop})},setDetailedBasePairRequest:function(e,t){e.commit("detailedBasePairRequest",t)},setDetailedBasePairRange:function(e,t){e.commit("detailedBasePairRange",t)},setBackboneOrthologData:function(e,t){e.commit("backboneOrthologs",t)},setSelectionToastCount:function(e,t){e.commit("selectionToastCount",t)}},getters:{isLoadByGene:function(e){return"gene"===e.configMode},isLoadByPosition:function(e){return"position"===e.configMode}},plugins:[s.plugin]})},8806:(e,t,n)=>{n.d(t,{CK:()=>c,EJ:()=>l,UI:()=>s,xl:()=>r});n(1532),n(1539),n(8783),n(3948),n(9554),n(4747),n(8309),n(7658),n(2707),n(6755),n(1249),n(3290);var a=n(8561),o=n(5996),i=6;function s(e,t,n){var i=e.state.comparativeSpecies,s=new Map;i.forEach((function(e){return s.set(e.activeMap.key,e.name)}));var r=[],l=[],c=n.get(t.rgdId);return c&&((0,o.OL)(c,n,r),r.length>0&&r.forEach((function(e){var t=n.get(e);t&&l.push(new a.Z(t.clone(),"Gene"))}))),{rgdIds:r,selectedData:l}}function r(e){e.sort((function(e,t){var n=e.symbol.startsWith("LOC")||!1,a=t.symbol.startsWith("LOC")||!1;if(n&&a){var o=e.symbol.toLowerCase()||"",i=t.symbol.toLowerCase()||"";return o<i?-1:o>i?1:0}if(n)return 1;if(a)return-1;var s=e.symbol.toLowerCase()||"",r=t.symbol.toLowerCase()||"";return s<r?-1:s>r?1:0}))}function l(e,t,n){var a,o,s=e.stop-e.start,r=Math.max(Math.floor(e.start-i*s),0),l=Math.min(Math.floor(e.stop+i*s),null!==(a=null===(o=n.state.chromosome)||void 0===o?void 0:o.seqLength)&&void 0!==a?a:r),c=[];if(e.orthologs&&e.orthologs.forEach((function(e){var n=t.get(e);n&&c.push(n)})),c.length>0){var u,d;c.push(e),c.sort((function(e,t){return e.backboneStart-t.backboneStart}));var p=Math.max(Math.floor(c[0].backboneStart-i*s),0),v=Math.min(Math.floor(c[c.length-1].backboneStop+i*s),null!==(u=null===(d=n.state.chromosome)||void 0===d?void 0:d.seqLength)&&void 0!==u?u:p);return{start:p,stop:v}}return{start:r,stop:l}}function c(e,t){return e=e.toLowerCase(),t.sort((function(t,n){var a=u(e,t.symbol.toLowerCase()),o=u(e,n.symbol.toLowerCase());return a-o}))}function u(e,t){for(var n=Array(t.length+1).fill(null).map((function(){return Array(e.length+1).fill(0)})),a=0;a<=e.length;a++)n[0][a]=a;for(var o=0;o<=t.length;o++)n[o][0]=o;for(var i=1;i<=t.length;i++)for(var s=1;s<=e.length;s++)t.charAt(i-1)===e.charAt(s-1)?n[i][s]=n[i-1][s-1]:n[i][s]=Math.min(n[i-1][s]+1,n[i][s-1]+1,n[i-1][s-1]+1);return n[t.length][e.length]}},8114:(e,t,n)=>{n.d(t,{M:()=>a});var a;n(6977);(function(e){function t(e){return null==e?null:(e/1e6).toFixed(2)+"Mbp"}function n(e){return null==e?null:e.toLocaleString()}function a(e){return null===e?null:e}e.convertBasePairToLabel=t,e.addCommasToBasePair=n,e.evaluateBPInput=a})(a||(a={}))},5996:(e,t,n)=>{n.d(t,{OL:()=>f,oE:()=>p,XK:()=>b});var a=n(9584),o=(n(7327),n(1539),n(1038),n(8783),n(3948),n(1532),n(9554),n(4747),n(4944),n(3792),n(1249),n(7658),n(2707),n(2222),n(6699),n(2023),n(5556)),i=n(2833),s=n(3087),r=(0,i.Z)((function e(t){var n,a,o,i;(0,s.Z)(this,e),this.posX1=0,this.posX2=0,this.posY1=0,this.posY2=0,this.height=0,this.width=0,this.shape="rect",this.representation="",this.isHovered=!1,this.isSelected=!1,this.elementColor="",this.startGeneDatatrack=null,this.endGeneDatatrack=null,this.chainedOrthologLines=[],this.startGene=t.startGene,this.endGene=t.endGene,this.posX1=t.x1,this.posX2=t.x2,this.posY1=t.y1,this.posY2=t.y2,this.startGeneDatatrack=null!==(n=t.startGeneDatatrack)&&void 0!==n?n:null,this.endGeneDatatrack=null!==(a=t.endGeneDatatrack)&&void 0!==a?a:null,null===(o=this.startGeneDatatrack)||void 0===o||o.lines.push(this),null===(i=this.endGeneDatatrack)||void 0===i||i.lines.push(this)})),l=n(8561),c=n(8451),u=n(2095),d=.5;function p(e,t,n){o.Z.time("CreateOrthologLines"),o.Z.time("Ortholog Line Data Prep");var i=(0,c.zQ)(t.backbone.windowStop-t.backbone.windowStart)*d,s=Array.from(e.values()).filter((function(e){return e.mapKey===t.mapKey&&e.orthologs.length>0&&e.backboneStop-e.backboneStart>=i})),l=new Map,p=(0,c.pE)(t.backbone.posX2,t.geneDatatrackSetIndex);l.set(t.mapKey,{order:0,startX:p,endX:p+u.ZP.dataTrackWidth}),n.forEach((function(e){var t=(0,c.uc)(e.order,e.geneDatatrackSetIndex),n=t+u.ZP.dataTrackWidth;l.set(e.mapKey,{order:e.order,startX:t,endX:n})}));var h=t.datatrackSets.filter((function(e){var t;return"gene"===(null===(t=e.datatracks[0])||void 0===t?void 0:t.type)})).flat().map((function(e){return e.datatracks})).flat(),g=new Map;h.forEach((function(e){g.set(e.gene.rgdId,e)})),n.forEach((function(e){for(var t=0;t<e.regions.length;t++){var n=e.regions[t],a=n.datatrackSets.filter((function(e){var t;return"gene"===(null===(t=e.datatracks[0])||void 0===t?void 0:t.type)})).map((function(e){return e.datatracks})).flat();a.forEach((function(e){g.set(e.gene.rgdId,e)}))}})),o.Z.timeEnd("Ortholog Line Data Prep"),o.Z.time("Ortholog Line Creation");var b=[],f=[];s.forEach((function(t){var n=[];t.orthologs.forEach((function(t){var a=e.get(t);a&&n.push(a)}));var a=new Map;a.set(0,[t]),n.sort((function(e,t){var n=l.get(e.mapKey),a=l.get(t.mapKey);return n&&a?n.order-a.order:0})).forEach((function(e){var t,n,i=null===(t=l.get(e.mapKey))||void 0===t?void 0:t.order;null!=i?a.has(i)?null===(n=a.get(i))||void 0===n||n.push(e):a.set(i,[e]):o.Z.error("No order was returned from speciesPositionMap for ortholog gene rgdId: ".concat(e.rgdId))})),a.size>1&&f.push(a)}));var m=n.length,k=t.backbone.windowStart,S=t.backbone.windowStop;return f.forEach((function(e){for(var t=[],n=[],o=function(o){var i,s=e.get(o);return null==s?"continue":0===t.length?((i=t).push.apply(i,(0,a.Z)(s)),"continue"):(t.forEach((function(e){s.forEach((function(t){var a,o,i,s;v(e,t,k,S)&&n.push(new r({startGene:e.clone(),endGene:t.clone(),x1:null!==(a=null===(o=l.get(e.mapKey))||void 0===o?void 0:o.endX)&&void 0!==a?a:0,x2:null!==(i=null===(s=l.get(t.mapKey))||void 0===s?void 0:s.startX)&&void 0!==i?i:0,y1:(0,c.f_)(e.backboneStart,e.backboneStop,k,S),y2:(0,c.f_)(t.backboneStart,t.backboneStop,k,S),startGeneDatatrack:g.get(e.rgdId),endGeneDatatrack:g.get(t.rgdId)}))}))})),void(t=s))},i=0;i<=m;i++)o(i);for(var s=function(e){n[e].chainedOrthologLines=n.filter((function(t){return t.startGene.rgdId!==n[e].startGene.rgdId||t.endGene.rgdId!==n[e].endGene.rgdId}))},u=0;u<n.length;u++)s(u);b.push.apply(b,n)})),o.Z.timeEnd("Ortholog Line Creation"),o.Z.timeEnd("CreateOrthologLines"),b}function v(e,t,n,a){var o,i,s,r,l=null!==(o=e.backboneStart)&&void 0!==o?o:e.start,c=null!==(i=e.backboneStop)&&void 0!==i?i:e.stop,u=null!==(s=t.backboneStart)&&void 0!==s?s:t.start,d=null!==(r=t.backboneStop)&&void 0!==r?r:t.stop;return!!(h(l,n,a)||h(c,n,a)||h(u,n,a)||h(d,n,a))||(l<n&&c>a||u<n&&d>a||(c<n&&u>a||d<n&&l>a))}function h(e,t,n){return e>=t&&e<=n}function g(e){var t=new Map;return[e].concat((0,a.Z)(e.chainedOrthologLines)).forEach((function(e){t.set(e.startGene.rgdId,e.startGene),t.set(e.endGene.rgdId,e.endGene)})),t}function b(e){var t=g(e),n=Array.from(t.values()).map((function(e){return new l.Z(e,"Gene")})),a=Array.from(t.keys());return{selectedData:n,selectedGeneIds:a}}function f(e,t,n){n.includes(e.rgdId)||n.push(e.rgdId),e.orthologs.forEach((function(e){if(!n.includes(e)){var a=t.get(e);null!=a&&(n.push(e),f(a,t,n))}}))}},2095:(e,t,n)=>{n.d(t,{ZP:()=>r,_s:()=>s,ef:()=>o,lv:()=>i});var a={overviewPanelWidth:300,detailsPanelWidth:500,overviewTitleXPosition:10,detailsTitleXPosition:310,panelTitleYPosition:15,panelTitleHeight:55,backboneXPosition:260,viewboxHeight:440,trackWidth:20,dataTrackWidth:10,overviewTrackYPosition:70,trackLabelYPosition:25,trackMapLabelYPosition:35,selectedBackboneXPosition:320,navigationButtonHeight:15,overviewTrackPadding:15,backboneDatatrackXOffset:10},o=a.panelTitleHeight,i=a.viewboxHeight-a.navigationButtonHeight,s=i-o;const r=a},8451:(e,t,n)=>{n.d(t,{Oo:()=>r,f_:()=>d,go:()=>v,pE:()=>u,qN:()=>c,uZ:()=>p,uc:()=>l,zQ:()=>s});n(7327),n(1539);var a=n(2095),o=n(5556),i=.2;function s(e){return Math.round(e/(a.lv-a.ef)*i)}function r(e,t,n){return e.backboneStart>t&&e.backboneStart<n||e.backboneStop<n&&e.backboneStop>t||e.backboneStart<t&&e.backboneStop>n}function l(e,t){return c(e)+a.ZP.trackWidth+a.ZP.backboneDatatrackXOffset*(t+1)+a.ZP.backboneDatatrackXOffset*t}function c(e){return 140*e+a.ZP.selectedBackboneXPosition}function u(e,t){return e+a.ZP.backboneDatatrackXOffset*(t+1)+a.ZP.backboneDatatrackXOffset*t}function d(e,t,n,o){var i=a._s/(o-n),s=e-n,r=o-t,l=a.ef+s*i,c=a.lv-r*i;return l+(c-l)/2}function p(e,t,n){var a,i,s,r=n.gaps.filter((function(e){return e.chainLevel===n.chainLevel}));if(0===r.length)return v(e,t,n);for(var l=0;l<r.length;l++){var c,u,d,p,h,g,b,f,m,k,S,y,w=r[l];if(!a)if(e<w.start)a={start:null!==(c=null===(u=s)||void 0===u?void 0:u.stop)&&void 0!==c?c:n.start,stop:w.start,backboneStart:"-"===n.orientation?w.backboneStop:null!==(d=null===(p=s)||void 0===p?void 0:p.backboneStop)&&void 0!==d?d:n.backboneStart,backboneStop:"-"===n.orientation?null!==(h=null===(g=s)||void 0===g?void 0:g.backboneStart)&&void 0!==h?h:n.backboneStop:w.backboneStart};else e>=w.start&&e<=w.stop&&(a={start:w.start,stop:w.stop,backboneStart:w.backboneStart,backboneStop:w.backboneStop});if(a&&!i)if(t<w.start)i={start:null!==(b=null===(f=s)||void 0===f?void 0:f.stop)&&void 0!==b?b:n.start,stop:w.start,backboneStart:"-"===n.orientation?w.backboneStop:null!==(m=null===(k=s)||void 0===k?void 0:k.backboneStop)&&void 0!==m?m:n.backboneStart,backboneStop:"-"===n.orientation?null!==(S=null===(y=s)||void 0===y?void 0:y.backboneStart)&&void 0!==S?S:n.backboneStop:w.backboneStart};else t>=w.start&&t<=w.stop&&(i={start:w.start,stop:w.stop,backboneStart:w.backboneStart,backboneStop:w.backboneStop});if(l===r.length-1&&n.stop>w.stop&&(!a||!i)){var P={start:w.stop,stop:n.stop,backboneStart:"-"===n.orientation?n.backboneStart:w.backboneStop,backboneStop:"-"===n.orientation?w.backboneStart:n.backboneStop};a||(a=P),i||(i=P)}if(s=w,a&&i)break}if(!a||!i)return o.Z.error("Gene backbone alignment could not be determined based on block with gaps. See debug logs."),o.Z.debug(e,t,n),v(e,t,n);var Z,B,D=Math.abs(a.backboneStop-a.backboneStart)/Math.abs(a.stop-a.start),L=Math.abs(i.backboneStop-i.backboneStart)/Math.abs(i.stop-i.start);return"+"===n.orientation?(Z=Math.floor(a.backboneStart+(e-a.start)*D),B=Math.floor(i.backboneStart+(t-i.start)*L)):(Z=Math.floor(i.backboneStart+(i.stop-t)*L),B=Math.floor(a.backboneStart+(a.stop-e)*D)),Z<n.backboneStart&&(Z=n.backboneStart),B>n.backboneStop&&(B=n.backboneStop),{start:Z,stop:B}}function v(e,t,n){var a,o,i=Math.abs(n.backboneStop-n.backboneStart)/Math.abs(n.stop-n.start);return"+"==n.orientation?(a=Math.floor(n.backboneStart+(e-n.start)*i),o=Math.floor(n.backboneStart+(t-n.start)*i)):(a=Math.floor(n.backboneStart+(n.stop-t)*i),o=Math.floor(n.backboneStart+(n.stop-e)*i)),a<n.backboneStart&&(a=n.backboneStart),o>n.backboneStop&&(o=n.backboneStop),{start:a,stop:o}}},4970:(e,t,n)=>{n.d(t,{q:()=>a});var a="0.9.0"},9811:(e,t,n)=>{n.d(t,{Z:()=>d});n(7658);var a=n(6252),o=n(2262),i=n(3577),s=n(2201),r={class:"grid"},l={key:0,class:"col-6 text-left"};const c=(0,a.aZ)({__name:"VCMapDialog",props:{header:null,message:null,show:{type:Boolean},theme:null,showBackButton:{type:Boolean},onConfirmCallback:null},emits:["update:show"],setup:function(e,t){var n=t.emit,c=e,u=(0,s.tv)(),d=(0,a.Fl)({get:function(){return c.show},set:function(e){n("update:show",e)}}),p=function(){n("update:show",!1)},v=function(){p(),u.push("/")},h=function(){p(),c.onConfirmCallback&&c.onConfirmCallback()};return function(e,t){var n=(0,a.up)("Button"),s=(0,a.up)("Dialog");return(0,a.wg)(),(0,a.j4)(s,{header:c.header,visible:(0,o.SU)(d),"onUpdate:visible":t[0]||(t[0]=function(e){return(0,o.dq)(d)?d.value=e:null}),class:"vcmap-dialog",breakpoints:{"960px":"75vw","640px":"100vw"},draggable:!1,closable:!1,modal:!0},{footer:(0,a.w5)((function(){return[(0,a.WI)(e.$slots,"footer",{},(function(){return[(0,a._)("div",r,[c.showBackButton?((0,a.wg)(),(0,a.iD)("div",l,[(0,a.Wm)(n,{label:"Back to Configuration",class:(0,i.C_)([{"p-button-danger":"error"===c.theme},"p-button-outlined"]),onClick:v},null,8,["class"])])):(0,a.kq)("",!0),(0,a._)("div",{class:(0,i.C_)(c.showBackButton?"col-6":"col-12")},[(0,a.Wm)(n,{label:c.showBackButton?"Ok, proceed anyway":"Ok",class:(0,i.C_)({"p-button-danger":"error"===c.theme}),onClick:h,autofocus:""},null,8,["label","class"])],2)])]}))]})),default:(0,a.w5)((function(){return[(0,a.WI)(e.$slots,"content",{},(function(){return[(0,a._)("p",null,(0,i.zw)(c.message),1)]}))]})),_:3},8,["header","visible"])}}}),u=c,d=u},4186:(e,t,n)=>{e.exports=n.p+"img/rgd_logo.0533eaed.png"},2546:(e,t,n)=>{e.exports=n.p+"img/vcmap_logo_v2.a122e07a.png"}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n.m=e,(()=>{var e=[];n.O=(t,a,o,i)=>{if(!a){var s=1/0;for(u=0;u<e.length;u++){for(var[a,o,i]=e[u],r=!0,l=0;l<a.length;l++)(!1&i||s>=i)&&Object.keys(n.O).every((e=>n.O[e](a[l])))?a.splice(l--,1):(r=!1,i<s&&(s=i));if(r){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[a,o,i]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}})(),(()=>{n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,a)=>(n.f[a](e,t),t)),[]))})(),(()=>{n.u=e=>"js/configuration.dd79cb48.js"})(),(()=>{n.miniCssF=e=>"css/configuration.cf5c7ccf.css"})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="vcmap-web:";n.l=(a,o,i,s)=>{if(e[a])e[a].push(o);else{var r,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+i){r=d;break}}r||(l=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,n.nc&&r.setAttribute("nonce",n.nc),r.setAttribute("data-webpack",t+i),r.src=a),e[a]=[o];var p=(t,n)=>{r.onerror=r.onload=null,clearTimeout(v);var o=e[a];if(delete e[a],r.parentNode&&r.parentNode.removeChild(r),o&&o.forEach((e=>e(n))),t)return t(n)},v=setTimeout(p.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=p.bind(null,r.onerror),r.onload=p.bind(null,r.onload),l&&document.head.appendChild(r)}}})(),(()=>{n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{n.p="/vcmap/"})(),(()=>{if("undefined"!==typeof document){var e=(e,t,n,a,o)=>{var i=document.createElement("link");i.rel="stylesheet",i.type="text/css";var s=n=>{if(i.onerror=i.onload=null,"load"===n.type)a();else{var s=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=s,l.request=r,i.parentNode.removeChild(i),o(l)}};return i.onerror=i.onload=s,i.href=t,n?n.parentNode.insertBefore(i,n.nextSibling):document.head.appendChild(i),i},t=(e,t)=>{for(var n=document.getElementsByTagName("link"),a=0;a<n.length;a++){var o=n[a],i=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(i===e||i===t))return o}var s=document.getElementsByTagName("style");for(a=0;a<s.length;a++){o=s[a],i=o.getAttribute("data-href");if(i===e||i===t)return o}},a=a=>new Promise(((o,i)=>{var s=n.miniCssF(a),r=n.p+s;if(t(s,r))return o();e(a,r,null,o,i)})),o={143:0};n.f.miniCss=(e,t)=>{var n={639:1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=a(e).then((()=>{o[e]=0}),(t=>{throw delete o[e],t})))}}})(),(()=>{var e={143:0};n.f.j=(t,a)=>{var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)a.push(o[2]);else{var i=new Promise(((n,a)=>o=e[t]=[n,a]));a.push(o[2]=i);var s=n.p+n.u(t),r=new Error,l=a=>{if(n.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var i=a&&("load"===a.type?"missing":a.type),s=a&&a.target&&a.target.src;r.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",r.name="ChunkLoadError",r.type=i,r.request=s,o[1](r)}};n.l(s,l,"chunk-"+t,t)}},n.O.j=t=>0===e[t];var t=(t,a)=>{var o,i,[s,r,l]=a,c=0;if(s.some((t=>0!==e[t]))){for(o in r)n.o(r,o)&&(n.m[o]=r[o]);if(l)var u=l(n)}for(t&&t(a);c<s.length;c++)i=s[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},a=self["webpackChunkvcmap_web"]=self["webpackChunkvcmap_web"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=n.O(void 0,[998],(()=>n(6453)));a=n.O(a)})();
//# sourceMappingURL=app.a4234dc2.js.map